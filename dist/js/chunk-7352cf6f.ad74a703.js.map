{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.date.to-string.js","webpack:///./src/views/NewMessage.vue?fabf","webpack:///./src/assets/img/speaker.svg","webpack:///./node_modules/core-js/modules/es.date.now.js","webpack:///./node_modules/core-js/modules/es.object.define-property.js","webpack:///./src/views/Play.vue?7a49","webpack:///./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack:///./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack:///./src/views/CubeObject.js","webpack:///./src/views/NewMessage.vue?97fd","webpack:///src/views/NewMessage.vue","webpack:///./src/views/NewMessage.vue?c095","webpack:///./src/views/NewMessage.vue","webpack:///src/views/Play.vue","webpack:///./src/views/Play.vue?6236","webpack:///./src/views/Play.vue","webpack:///./node_modules/three-pointerlock/index.js","webpack:///./src/views/Play.vue?fa8c","webpack:///./src/assets/img/lock.svg","webpack:///./src/assets/img/lock.png","webpack:///./node_modules/three-collada-loader/index.js"],"names":["redefine","DatePrototype","Date","prototype","INVALID_DATE","TO_STRING","nativeDateToString","getTime","NaN","value","call","this","module","exports","$","target","stat","now","DESCRIPTORS","objectDefinePropertyModile","forced","sham","defineProperty","f","render","_vm","_h","$createElement","_c","_self","staticClass","_m","attrs","name","jobs","_l","message","key","id","_v","_s","content","timestamp","directives","rawName","controlsEnabled","expression","ref","on","clickOnInstructions","staticStyle","$event","movePosition","staticRenderFns","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","i","length","descriptor","enumerable","configurable","writable","Object","_createClass","protoProps","staticProps","CubeObject","width","height","depth","geometry","THREE","setVertexColors","l","faces","face","vertexColors","vertexColor","setHSL","Math","random","material","specular","flatShading","color","mesh","x","y","z","position","setMaterial","setMesh","preventDefault","addMessage","domProps","composing","newMessage","feedback","_e","data","methods","console","log","err","component","components","NewMessage","messages","element","undefined","camera","scene","box","renderer","controls","objects","raycaster","blocker","instructions","havePointerLock","intersects","loadingScreen","loadingManager","moveForward","moveBackward","moveLeft","moveRight","canJump","sprinting","moveY","prevTime","velocity","created","onSnapshot","snapshot","docChanges","forEach","doc","init","set","fog","light","add","getObject","document","addEventListener","onScrollWheel","initCreateGround","initCreateHouse","initCube","initRenderer","window","onWindowResize","gammaOutput","gammaFactor","setClearColor","setPixelRatio","devicePixelRatio","setSize","innerWidth","innerHeight","appendChild","domElement","loader","load","cube","getObjectByName","push","animate","requestAnimationFrame","delta","handleInput","time","onTransitionEnd","event","remove","onKeyDown","onKeyUp","deltaY","isOnObject","ray","origin","copy","intersections","aspect","updateProjectionMatrix","pointerlockchange","enabled","pointerlockerror","requestPointerLock","mozRequestPointerLock","webkitRequestPointerLock","test","navigator","userAgent","requestFullscreen","mozRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","fullscreenchange","removeEventListener","computed","zInput","xInput","moveObjectA","mounted","$refs","canvas","performance","innerHTML","scope","rotation","pitchObject","Object3D","yawObject","Vector3","PI_2","PI","onMouseMove","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","max","min","keyCode","boolean","getDirection","direction","Euler","v","applyEuler","update","translateX","translateY","translateZ","ColladaLoader","visualScene","kinematicsModel","animData","kinematics","visualScenes","kinematicsModels","baseUrl","morphs","skins","COLLADA","readyCallbackFunc","sources","images","animations","controllers","geometries","materials","effects","cameras","lights","preferredShading","SmoothShading","options","centerGeometry","convertUpAxis","subdivideFaces","upAxis","defaultEnvMap","colladaUnit","colladaUp","upConversion","url","readyCallback","progressCallback","failCallback","implementation","createDocument","request","XMLHttpRequest","onreadystatechange","readyState","status","response","parse","error","getResponseHeader","total","loaded","responseText","open","send","alert","text","callBack","DOMParser","parseFromString","parts","split","pop","join","parseAsset","setUpConversion","parseLib","_Image","Material","Effect","Geometry","Camera","Light","Controller","Animation","VisualScene","KinematicsModel","parseScene","Group","nodes","createSceneGraph","scale","multiplyScalar","createAnimations","parseKinematicsModel","createKinematics","result","dae","setPreferredShading","shading","elements","querySelectorAll","childNodes","child","nodeName","meter","getAttribute","parseFloat","textContent","charAt","q","classSpec","prefix","lib","elementsLength","j","daeElement","sceneElement","replace","kinematicsModelElement","recurseHierarchy","node","n","getChildById","colladaId","newData","keys","fps","hierarchy","sids","il","children","d","jl","calcAnimationBounds","ID","start","end","frames","animation","sampler","create","startTime","endTime","input","createMorph","ctrl","morphCtrl","InstanceController","morph","targets","target_id","daeGeometry","primitives","vertices","morphTargets","setupSkeleton","bones","frame","parent","world","Matrix4","localworld","matrix","channels","channel","m","output","multiplyMatrices","setupSkinningMatrices","skin","bone","found","type","joints","sid","inv","invBindMatrices","invBindMatrix","skinningMatrix","animatrix","weights","k","w","joint","warn","flattenSkeleton","skeleton","list","walk","parentid","Quaternion","decompose","pos","scl","rotq","skinToBindPose","skinController","skinned","vidx","index","weight","o","s","applyMatrix4","applySkin","instanceCtrl","animationBounds","getChildBySid","bonelist","sortedbones","bindShapeMatrix","skinIndices","skinWeights","indicies","Vector4","animationdata","rot","jointMap","_addToMap","jointIndex","parentVisualElement","parentVisualElementId","colladaNode","traverse","transforms","zeroPosition","getJointValue","jointData","setJointValue","limits","static","threejsNode","axis","transform","indexOf","multiply","m1","makeRotationAxis","degToRad","makeTranslation","obj","angle","elementsFloat32Arr","Array","slice","elementsRowMajor","apply","quaternion","querySelector","nodeType","visualTarget","parseInt","visualTargetElement","parentElement","morphController","controller","source","inst_geom","InstanceGeometry","instance_material","second","double_sided_materials","first_material","instance_geometry","instance_materials","used_materials","used_materials_array","num_materials","mat","effect_id","instance_effect","shader","material3js","doubleSided","symbol","_copied_material","clone","side","DoubleSide","opacity","MeshLambertMaterial","FrontSide","geom","geometry3js","MultiMaterial","skinning","SkinnedMesh","Mesh","isLineStrip","Line","instance_camera","cparams","cam","PerspectiveCamera","yfov","aspect_ratio","znear","zfar","instance_light","lparams","technique","getHex","intensity","distance","falloff_angle","DirectionalLight","PointLight","SpotLight","AmbientLight","layer","center","applyQuaternion","sub","getLibraryNode","attObj","attributes","getNamedItem","getChannelsForNode","bakeAnimations","member","fullSid","getTransformBySid","arrIndices","getConvertedIndex","getConvertedMember","getData","findKey","Key","timeNdx","findTimeNdx","splice","addTarget","hasTarget","interpolateKeys","retVal","ndx","prevKey","getPrevKeyWith","nextKey","getNextKeyWith","prevTarget","getTarget","nextData","prevData","init_from","Morph","method","Skin","Node","Transform","InstanceMaterial","Polygons","count","inputs","vcount","p","Polylist","LineStrips","Triangles","Accessor","stride","params","Vertices","Input","semantic","offset","Source","ColorOrTexture","Color","setRGB","a","texture","texcoord","texOpts","Shader","effect","Surface","format","Sampler2D","wrap_s","wrap_t","minfilter","magfilter","mipfilter","surface","InstanceEffect","Channel","dotSyntax","arrSyntax","Sampler","strideOut","interpolation","duration","InstanceCamera","InstanceLight","links","Joint","middlePosition","Link","attachments","Attachment","_source","_bools","str","raw","_strings","_floats","_ints","_trimString","_attr_as_int","defaultValue","hasAttribute","loadTextureImage","ImageLoader","image","needsUpdate","extractDoubleSided","fixCoords","sign","tmp","getConvertedTranslation","getConvertedVec3","arr","getConvertedMat4","members","indices","X","Y","Z","parseInputs","read","src","parseJoints","parseWeights","numBones","vertex_weights","influence","recursive","getChannelForTransform","transformSid","shift","info","iNode","updateMatrix","identity","convert","n11","n21","n31","n41","n12","n22","n32","n42","n13","n23","n33","n43","n14","n24","n34","n44","propName","toString","instances","vertexData","primitive","setVertices","handlePrimitive","calcNormals","computeVertexNormals","idx32","numParams","pList","vcIndex","maxOffset","texture_sets","pCount","vs","ns","ts","cs","accessor","Vector2","NORMAL","len","TEXCOORD","COLOR","uv","uvArr","Face3","clr","daeMaterial","faceVertexUvs","constructor","param","isColor","isTexture","opaque","rgba","offsetU","offsetV","repeatU","repeatV","wrapU","wrapV","parseTexture","toUpperCase","bumpType","toLowerCase","transparent","transparencyLevel","r","g","b","transparency","prop","cot","samplerId","surfaceId","Loader","Handlers","get","Texture","wrapS","RepeatWrapping","ClampToEdgeWrapping","wrapT","repeat","MixOperation","diffuse","emissive","MeshBasicMaterial","MeshPhongMaterial","parseTechnique","parseProfileCOMMON","parseNewparam","_image","parseExtra","parseExtraTechnique","anim","opt_sid","interpolate","nextTarget","parseOptics","perspective","xfov","orthographic","xmag","ymag","parseCommon","sqrt","profile","axisElement","_axis","jointTypes","jointElement"],"mappings":"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","file":"js/chunk-7352cf6f.ad74a703.js","sourcesContent":["var redefine = require('../internals/redefine');\n\nvar DatePrototype = Date.prototype;\nvar INVALID_DATE = 'Invalid Date';\nvar TO_STRING = 'toString';\nvar nativeDateToString = DatePrototype[TO_STRING];\nvar getTime = DatePrototype.getTime;\n\n// `Date.prototype.toString` method\n// https://tc39.github.io/ecma262/#sec-date.prototype.tostring\nif (new Date(NaN) + '' != INVALID_DATE) {\n  redefine(DatePrototype, TO_STRING, function toString() {\n    var value = getTime.call(this);\n    // eslint-disable-next-line no-self-compare\n    return value === value ? nativeDateToString.call(this) : INVALID_DATE;\n  });\n}\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NewMessage.vue?vue&type=style&index=0&id=716f741a&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NewMessage.vue?vue&type=style&index=0&id=716f741a&lang=scss&scoped=true&\"","module.exports = __webpack_public_path__ + \"img/speaker.46efd460.svg\";","var $ = require('../internals/export');\n\n// `Date.now` method\n// https://tc39.github.io/ecma262/#sec-date.now\n$({ target: 'Date', stat: true }, {\n  now: function now() {\n    return new Date().getTime();\n  }\n});\n","var $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar objectDefinePropertyModile = require('../internals/object-define-property');\n\n// `Object.defineProperty` method\n// https://tc39.github.io/ecma262/#sec-object.defineproperty\n$({ target: 'Object', stat: true, forced: !DESCRIPTORS, sham: !DESCRIPTORS }, {\n  defineProperty: objectDefinePropertyModile.f\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"play\"},[_vm._m(0),_c('NewMessage',{attrs:{\"name\":_vm.name,\"jobs\":_vm.jobs}}),_vm._l((_vm.messages),function(message){return _c('li',{key:message.id},[_c('span',[_vm._v(_vm._s(message.name))]),_c('span',[_vm._v(_vm._s(message.jobs))]),_c('span',[_vm._v(_vm._s(message.content))]),_c('span',[_vm._v(_vm._s(message.timestamp))])])}),_c('transition',{attrs:{\"name\":\"fade\"}},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.controlsEnabled),expression:\"!controlsEnabled\"}],ref:\"blocker\",attrs:{\"id\":\"blocker\"}},[_c('div',{ref:\"instructions\",attrs:{\"id\":\"instructions\"},on:{\"click\":_vm.clickOnInstructions}},[_c('span',{staticStyle:{\"font-size\":\"40px\"}},[_vm._v(\"Click to play \"+_vm._s(this.name)+\" \")]),_c('br'),_vm._v(\" (W, A, S, D = Move, SPACE = Jump, MOUSE = Look aroundt) \")])])]),_c('div',{staticClass:\"controls\"},[_c('button',{on:{\"click\":function($event){return _vm.movePosition(5,5,0)}}},[_vm._v(\"Move a\")]),_c('button',{on:{\"click\":function($event){return _vm.movePosition(5,15,0)}}},[_vm._v(\"Move b\")]),_c('button',{on:{\"click\":function($event){return _vm.movePosition(15,5,0)}}},[_vm._v(\"Move c\")])]),_c('div',{ref:\"canvas\",staticClass:\"container\"},[_vm._m(1)])],2)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{attrs:{\"id\":\"loading-screen\"}},[_c('div',{attrs:{\"id\":\"loader\"}}),_c('div',{staticClass:\"lock\"},[_c('img',{attrs:{\"src\":require(\"@/assets/img/lock.png\"),\"alt\":\"lock\"}})])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"wrapper\"},[_c('div',{staticClass:\"left-down\"},[_c('div',{staticClass:\"map\"},[_c('img',{attrs:{\"src\":require(\"@/assets/img/facbook.svg\"),\"alt\":\"Facebook_WeProvide\"}})])]),_c('div',{staticClass:\"right-down\"},[_c('div',{staticClass:\"fullscreen\"},[_c('img',{attrs:{\"src\":require(\"@/assets/img/facbook.svg\"),\"alt\":\"Facebook_WeProvide\"}})]),_c('div',{staticClass:\"sound\"},[_c('img',{attrs:{\"src\":require(\"@/assets/img/speaker.svg\"),\"alt\":\"Sound\"}})])]),_c('div',{staticClass:\"center-down\"},[_c('div',{staticClass:\"mouse m-1\"})]),_c('div',{staticClass:\"top-right\"},[_c('div',{staticClass:\"lock\"},[_c('img',{attrs:{\"src\":require(\"@/assets/img/lock.svg\"),\"alt\":\"Lock\"}})])]),_c('div',{staticClass:\"center\"},[_c('div',{staticClass:\"marker\"})])])}]\n\nexport { render, staticRenderFns }","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","import * as THREE from 'three';\r\n\r\nexport default class CubeObject \r\n{\r\n  constructor(width, height, depth) {\r\n    this.geometry = new THREE.BoxGeometry(width, height, depth);\r\n    this.setVertexColors();\r\n  }\r\n\r\n  setVertexColors () {\r\n    for (let i = 0, l = this.geometry.faces.length; i < l; i++) {\r\n      let face = this.geometry.faces[i];\r\n      face.vertexColors[0] = this.vertexColor();\r\n      face.vertexColors[1] = this.vertexColor();\r\n      face.vertexColors[2] = this.vertexColor();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  vertexColor () {\r\n    return new THREE.Color().setHSL( Math.random() * 0.3 + 0.5, 0.75, Math.random() * 0.25 + 0.75 );\r\n  }\r\n\r\n  setMaterial () {\r\n    this.material = new THREE.MeshPhongMaterial({\r\n        specular: 0xffffff, \r\n        flatShading: THREE.FlatShading, \r\n        vertexColors: THREE.VertexColors \r\n    });\r\n    this.material.color.setHSL(Math.random() * 0.2 + 0.5, 0.75, Math.random() * 0.25 + 0.75);\r\n    return this;\r\n  }\r\n\r\n  setMesh () {\r\n    this.mesh = new THREE.Mesh(this.geometry, this.material);\r\n    return this;\r\n  }\r\n\r\n  setPosition (x, y, z) {\r\n    this.mesh.position.x = x;\r\n    this.mesh.position.y = y;\r\n    this.mesh.position.z = z;\r\n    return this;\r\n  }\r\n\r\n  create () {\r\n    this.setMaterial();\r\n    this.setMesh();\r\n    return this;\r\n  }\r\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"new-message\"},[_c('form',{on:{\"submit\":function($event){$event.preventDefault();return _vm.addMessage($event)}}},[_c('label',{attrs:{\"for\":\"new-message\"}},[_vm._v(\"New Message (enter to add):\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.newMessage),expression:\"newMessage\"}],attrs:{\"type\":\"text\",\"name\":\"new-message\"},domProps:{\"value\":(_vm.newMessage)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.newMessage=$event.target.value}}}),(_vm.feedback)?_c('p',[_vm._v(_vm._s(_vm.feedback))]):_vm._e()])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"new-message\">\r\n    <form @submit.prevent=\"addMessage\">\r\n      <label for=\"new-message\">New Message (enter to add):</label>\r\n      <input type=\"text\" name=\"new-message\" v-model=\"newMessage\">\r\n      <p v-if=\"feedback\">{{ feedback }}</p>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport db from '@/firebase/init'\r\n\r\nexport default {\r\n  name: 'NewMessage',\r\n  props: ['name', 'jobs'], \r\n  data(){\r\n    return{\r\n      newMessage: null,\r\n      feedback: null,\r\n    }\r\n  },\r\n  methods: {\r\n    addMessage(){\r\n      if(this.newMessage){\r\n        db.collection('messages').add({\r\n          content: this.newMessage,\r\n          name: this.name,\r\n          jobs: this.jobs,\r\n          timestamp: Date.now(),\r\n        }).catch(err => {\r\n          console.log(err)\r\n        })\r\n      } else{\r\n        this.feedback = \"You must enter a message in order to send one\"\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.play{\r\n  .new-message{\r\n    color: black;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NewMessage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NewMessage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./NewMessage.vue?vue&type=template&id=716f741a&scoped=true&\"\nimport script from \"./NewMessage.vue?vue&type=script&lang=js&\"\nexport * from \"./NewMessage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./NewMessage.vue?vue&type=style&index=0&id=716f741a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"716f741a\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"play\">\r\n    <section id=\"loading-screen\">\r\n      <div id=\"loader\"></div>\r\n      <div class=\"lock\">\r\n        <img src=\"@/assets/img/lock.png\" alt=\"lock\">\r\n      </div>\r\n    </section>\r\n    <NewMessage :name=\"name\" :jobs=\"jobs\" />\r\n    <li v-for=\"message in messages\" :key=\"message.id\">\r\n      <span>{{ message.name }}</span>\r\n      <span>{{ message.jobs }}</span>\r\n      <span>{{ message.content }}</span>\r\n      <span>{{ message.timestamp }}</span>\r\n    </li>\r\n    <transition name=\"fade\">\r\n    <div id=\"blocker\" ref=\"blocker\" v-show=\"!controlsEnabled\">\r\n\t\t\t<div id=\"instructions\" ref=\"instructions\" @click=\"clickOnInstructions\">\r\n\t\t\t\t<span style=\"font-size:40px\">Click to play {{ this.name }} </span>\r\n\t\t\t\t<br />\r\n\t\t\t\t(W, A, S, D = Move, SPACE = Jump, MOUSE = Look aroundt)\r\n\t\t\t</div>\r\n\t\t</div>\r\n    </transition>\r\n    <div class=\"controls\">\r\n      <button @click=\"movePosition(5,5,0)\">Move a</button>\r\n      <button @click=\"movePosition(5,15,0)\">Move b</button>\r\n      <button @click=\"movePosition(15,5,0)\">Move c</button>\r\n    </div>\r\n    <div class=\"container\" ref=\"canvas\">\r\n      <div class=\"wrapper\">\r\n        <div class=\"left-down\">\r\n          <div class=\"map\">\r\n            <img src=\"~@/assets/img/facbook.svg\" alt=\"Facebook_WeProvide\">\r\n          </div>\r\n        </div>\r\n        <div class=\"right-down\">\r\n          <div class=\"fullscreen\">\r\n            <img src=\"~@/assets/img/facbook.svg\" alt=\"Facebook_WeProvide\">\r\n          </div>\r\n          <div class=\"sound\">\r\n            <img src=\"~@/assets/img/speaker.svg\" alt=\"Sound\">\r\n          </div>\r\n        </div>\r\n        <div class=\"center-down\">\r\n          <div class=\"mouse m-1\"></div>\r\n        </div>\r\n        <div class=\"top-right\">\r\n          <div class=\"lock\">\r\n            <img src=\"~@/assets/img/lock.svg\" alt=\"Lock\">\r\n          </div>\r\n        </div>\r\n        <div class=\"center\">\r\n          <div class=\"marker\"></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as THREE from 'three';\r\nimport PointerLockControls from 'three-pointerlock'\r\nimport ColladaLoader from 'three-collada-loader'\r\nimport CubeObject from './../views/CubeObject'\r\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\r\nimport Stats from 'stats.js'\r\n\r\nimport { TimelineLite, TweenMax, Bounce, Power2, TweenLite  } from \"gsap\"\r\nimport { gsap, CSSPlugin } from 'gsap/all'\r\ngsap.registerPlugin(CSSPlugin)\r\n\r\nimport NewMessage from '@/views/NewMessage'\r\nimport db from '@/firebase/init'\r\nimport moment from 'moment'\r\nimport 'moment/locale/nl';\r\n\r\nexport default {\r\n  name: 'Play',\r\n  props: ['name', 'jobs'],\r\n  components: {\r\n    NewMessage\r\n  },\r\n  data () {\r\n    return {\r\n      messages: [],\r\n      element: undefined,\r\n      camera: undefined,\r\n      scene: undefined,\r\n      box: undefined,\r\n      renderer: undefined,\r\n      controls: undefined,\r\n      objects: [],\r\n      raycaster: undefined,\r\n      blocker: undefined,\r\n      instructions: undefined,\r\n      havePointerLock: undefined,\r\n      intersects: [],\r\n      loadingScreen: undefined,\r\n      loadingManager: null,\r\n\r\n      moveForward: false,\r\n      moveBackward: false,\r\n      moveLeft: false,\r\n      moveRight: false,\r\n      canJump: false,\r\n      sprinting: false,\r\n      moveY: 0,\r\n\r\n      prevTime: undefined,\r\n      velocity: undefined\r\n    };\r\n  },\r\n  created(){\r\n    let ref = db.collection('messages').orderBy('timestamp')\r\n\r\n    ref.onSnapshot(snapshot => {\r\n      snapshot.docChanges().forEach(change => {\r\n        if(change.type == 'added'){\r\n          let doc = change.doc\r\n          this.messages.push({\r\n            id: doc.id,\r\n            name: doc.data().name,\r\n            jobs: doc.data().jobs,\r\n            content: doc.data().content,\r\n            timestamp: moment(doc.data().timestamp).format('ll')\r\n          })\r\n        }\r\n      })\r\n    })\r\n  },\r\n  methods: {\r\n    init () {\r\n      this.camera = new THREE.PerspectiveCamera(90, window.innerWidth / window.innerHeight, 1, 1000);\r\n      this.camera.position.set(0, 30, 0);\r\n      console.log(this.camera.position);\r\n      this.scene = new THREE.Scene();\r\n      this.scene.fog = new THREE.Fog(0xffffff, 0, 750);\r\n\r\n      let light = new THREE.HemisphereLight(0xeeeeff, 0x777788, 0.75);\r\n      light.position.set(0.5, 1, 0.75);\r\n      this.scene.add(light);\r\n\r\n      this.controls = new PointerLockControls(this.camera);\r\n      this.scene.add(this.controls.getObject());\r\n\r\n      document.addEventListener('wheel', this.onScrollWheel, false);\r\n      document.addEventListener( 'keydown', this.onKeyDown, false );\r\n      document.addEventListener( 'keyup', this.onKeyUp, false );\r\n\r\n      this.raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3(0, -1, 0), 0, 10);\r\n      \r\n      // loading manager\r\n      this.loadingManager = new THREE.LoadingManager( () => {\r\n        // if loaded fade out loading screen\r\n        this.loadingScreen = document.getElementById( 'loading-screen' );\r\n        this.loadingScreen.classList.add( 'fade-out' );\r\n        // removing loadingscreen from DOM\r\n        this.loadingScreen.addEventListener( 'transitionend', this.onTransitionEnd );\r\n      } );\r\n\r\n      // this.moveObjectA();\r\n      this.initCreateGround();\r\n      this.initCreateHouse();\r\n      this.initCube();\r\n      this.initRenderer();\r\n      window.addEventListener('resize', this.onWindowResize, false);\r\n    },\r\n    initRenderer () {\r\n      this.renderer = new THREE.WebGLRenderer();\r\n      this.renderer.gammaOutput = true;\r\n      this.renderer.gammaFactor = 2.2;\r\n      this.renderer.setClearColor(0x151515);\r\n      this.renderer.setPixelRatio(window.devicePixelRatio);\r\n      this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n      this.element.appendChild(this.renderer.domElement);\r\n    },\r\n    initCreateGround () {\r\n      const loader = new GLTFLoader(this.loadingManager)\r\n      loader.load('/blender/grond.glb', gltf => {\r\n          this.scene.add(gltf.scene)\r\n          gltf.scene.position.set(0, 0, -100)\r\n          gltf.scene.scale.set(10, 10, 10)\r\n        },\r\n        function (xhr) {\r\n          console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );\r\n          \r\n        },\r\n        // called when loading has errors\r\n        function (error) {\r\n          console.log( 'An error happened' );\r\n        }\r\n      );\r\n    },\r\n    initCreateHouse () {\r\n      const loader = new GLTFLoader(this.loadingManager)\r\n      loader.load('/blender/room.glb', gltf => {\r\n          this.scene.add(gltf.scene)\r\n          // gltf.scene.rotation.y = 180\r\n          gltf.scene.position.set(0, 15, 0)\r\n          gltf.scene.scale.set(8, 8, 8)\r\n        },\r\n        function (xhr) {\r\n          console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );\r\n        },\r\n        // called when loading has errors\r\n        function (error) {\r\n          console.log( 'An error happened' );\r\n        }\r\n      );\r\n    },\r\n    initCube () {\r\n      var cube = this.scene.getObjectByName(\"Cube\");\r\n      cube = new CubeObject(20, 20, 20)\r\n        .create()\r\n        .setPosition(10,10,10)\r\n        \r\n      let mesh = cube.mesh;\r\n\r\n      this.scene.add(mesh);\r\n      this.objects.push(mesh);\r\n    },\r\n    animate () {\r\n      requestAnimationFrame(this.animate);\r\n      if (this.controlsEnabled) {\r\n        let time = performance.now();\r\n        let delta = ( time - this.prevTime ) / 1000;\r\n\r\n        this.velocity.x -= this.velocity.x * 10.0 * delta;\r\n        this.velocity.z -= this.velocity.z * 10.0 * delta;\r\n        this.velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\r\n\r\n        this.handleInput (delta) \r\n\r\n        if ( this.controls.getObject().position.y < 10 ) {\r\n          this.velocity.y = 0;\r\n          this.controls.getObject().position.y = 10;\r\n          this.canJump = true;\r\n        }\r\n        this.prevTime = time;\r\n      }\r\n\r\n      this.renderer.render( this.scene, this.camera );\r\n    },\r\n    onTransitionEnd( event ) {\r\n      event.target.remove();\r\n    },\r\n    handleInput (delta) {\r\n      this.velocity.z += (this.moveY * 10.0 * delta)\r\n      this.controls.getObject().position.z += this.velocity.z * delta;\r\n      this.moveY = 0;\r\n\r\n      // this.velocity.z += (this.zInput * 400.0 * delta) * (this.sprinting ? 2 : 1);\r\n      // this.velocity.x += (this.xInput * 400.0 * delta);\r\n\r\n      // if ( this.isOnObject() === true ) {\r\n      //     this.velocity.y = Math.max( 0, this.velocity.y );\r\n      //     this.canJump = true;\r\n      // }\r\n\r\n      // this.controls.getObject().translateX( this.velocity.x * delta );\r\n      // this.controls.getObject().translateY( this.velocity.y * delta );\r\n      // this.controls.getObject().translateZ( this.velocity.z * delta );\r\n    },\r\n    movePosition (x, y, z) {\r\n      this.controls.getObject().position.x = x;\r\n      this.controls.getObject().position.y = y;\r\n      this.controls.getObject().position.z = z;\r\n    },\r\n\r\n    onKeyDown (event) {\r\n      switch ( event.keyCode ) {\r\n        case 38: // up\r\n        case 87: // w\r\n          this.moveForward = true;\r\n          break;\r\n        case 37: // left\r\n        case 65: // a\r\n          this.moveLeft = true; \r\n          break;\r\n        case 40: // down\r\n        case 83: // s\r\n          this.moveBackward = true;\r\n          break;\r\n        case 39: // right\r\n        case 68: // d\r\n          this.moveRight = true;\r\n          break;\r\n        case 32: // space\r\n          if ( this.canJump === true ) {\r\n              this.velocity.y += 350;\r\n          }\r\n          this.canJump = false;\r\n          break;\r\n        case 16:\r\n          this.sprinting = true;\r\n          break;\r\n      }\r\n    },\r\n    onKeyUp (event) {\r\n      switch( event.keyCode ) {\r\n        case 38: // up\r\n        case 87: // w\r\n          this.moveForward = false;\r\n          break;\r\n        case 37: // left\r\n        case 65: // a\r\n          this.moveLeft = false;\r\n          break;\r\n        case 40: // down\r\n        case 83: // s\r\n          this.moveBackward = false;\r\n          break;\r\n        case 39: // right\r\n        case 68: // d\r\n          this.moveRight = false;\r\n          break;\r\n        case 16:\r\n          this.sprinting = false;\r\n          break;\r\n      }\r\n    },\r\n    onScrollWheel (event) {\r\n      let deltaY = event.deltaY;\r\n      if (deltaY > 0) {\r\n        this.moveY = 1;\r\n      }\r\n      if (deltaY < 0) {\r\n        this.moveY = -1;\r\n      }\r\n      this.moveY = deltaY;\r\n    },\r\n\r\n    isOnObject () {\r\n      this.raycaster.ray.origin.copy(this.controls.getObject().position);\r\n      this.raycaster.ray.origin.y -= 10;\r\n\r\n      let intersections = this.raycaster.intersectObjects(this.objects);\r\n      return intersections.length > 0;\r\n    },\r\n    \r\n    onWindowResize () {\r\n      this.camera.aspect = window.innerWidth / window.innerHeight;\r\n      this.camera.updateProjectionMatrix();\r\n      this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n    },\r\n\r\n    pointerlockchange () {\r\n      if ( document.pointerLockElement === this.element || document.mozPointerLockElement === this.element || document.webkitPointerLockElement === this.element ) {\r\n        this.controls.enabled = true;\r\n      } else {\r\n        this.controls.enabled = false;\r\n      }\r\n    },\r\n    pointerlockerror () {\r\n        // this.instructions.style.display = '';\r\n    },\r\n    clickOnInstructions () {\r\n      // this.instructions.style.display = 'none';\r\n\r\n      this.element.requestPointerLock = this.element.requestPointerLock || this.element.mozRequestPointerLock || this.element.webkitRequestPointerLock;\r\n\r\n      if (/Firefox/i.test(navigator.userAgent)) {\r\n        document.addEventListener( 'fullscreenchange', this.fullscreenchange, false );\r\n        document.addEventListener( 'mozfullscreenchange', this.fullscreenchange, false );\r\n        this.element.requestFullscreen = this.element.requestFullscreen || this.element.mozRequestFullscreen || this.element.mozRequestFullScreen || this.element.webkitRequestFullscreen;\r\n        this.element.requestFullscreen();\r\n      } else {\r\n        this.element.requestPointerLock();\r\n      }\r\n    },\r\n    fullscreenchange () {\r\n      if ( document.fullscreenElement === this.element || document.mozFullscreenElement === this.element || document.mozFullScreenElement === this.element ) {\r\n        document.removeEventListener( 'fullscreenchange', this.fullscreenchange );\r\n        document.removeEventListener( 'mozfullscreenchange', this.fullscreenchange );\r\n        this.element.requestPointerLock();\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    controlsEnabled () {\r\n      if (this.controls !== undefined) {\r\n        return this.controls.enabled;\r\n      }\r\n      return false;\r\n    },\r\n    // aspectRatio () {\r\n    //   return window.innerWidth / window.innerHeight;\r\n    // },\r\n    zInput () {\r\n      let value = 0;\r\n      value -= (this.moveForward ? 1 : 0);\r\n      value += (this.moveBackward ? 1 : 0);\r\n      return value;\r\n    },\r\n    xInput () {\r\n      let value = 0;\r\n      value -= (this.moveLeft ? 1 : 0);\r\n      value += (this.moveRight ? 1 : 0);\r\n      return value;\r\n    },\r\n    moveObjectA (){\r\n      if (this.camera.position.z = 30){\r\n        this.controls.getObject().position.y = y;\r\n      } \r\n    }\r\n  },\r\n  mounted () {\r\n    this.element = this.$refs.canvas;\r\n    this.blocker = this.$refs.blocker;\r\n    this.instructions = this.$refs.instructions;\r\n    const timeline = new TimelineLite()\r\n\r\n    this.prevTime = performance.now();\r\n    this.velocity = new THREE.Vector3();\r\n      \r\n    if ('pointerLockElement' in document || 'mozPointerLockElement' in document || 'webkitPointerLockElement' in document) {\r\n      document.addEventListener( 'pointerlockchange', this.pointerlockchange, false );\r\n      document.addEventListener( 'mozpointerlockchange', this.pointerlockchange, false );\r\n      document.addEventListener( 'webkitpointerlockchange', this.pointerlockchange, false );\r\n      document.addEventListener( 'pointerlockerror', this.pointerlockerror, false );\r\n      document.addEventListener( 'mozpointerlockerror', this.pointerlockerror, false );\r\n      document.addEventListener( 'webkitpointerlockerror', this.pointerlockerror, false );\r\n\r\n      this.init();\r\n      this.animate();\r\n    } else {\r\n      this.instructions.innerHTML = 'Your browser doesn\\'t seem to support Pointer Lock API';\r\n    }\r\n\r\n    // if (this.controls.enabled = true){\r\n\r\n    //   TweenLite.to(blocker, 1, {backgroundColor: red})\r\n\r\n    //   timeline.to(blocker, 1, {\r\n    //     delay: 4,\r\n    //     backgroundColor:\"red\",\r\n    //     ease: Power2.easeInOut \r\n    //   })\r\n    // }\r\n    \r\n\r\n\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.play{\r\n  width: 100%;\r\n\theight: 100%;\r\n  background-color: #ffffff;\r\n  margin: 0;\r\n  overflow: hidden;\r\n  #loading-screen {\r\n    position: absolute;\r\n    z-index: 16;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    background-color: #000000;\r\n    opacity: 1;\r\n    transition: 1s opacity;\r\n    .lock{\r\n      position: absolute;\r\n      z-index: 16;\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      height: 100%;\r\n      width: 100%;\r\n      opacity: 1;\r\n      transition: 1s opacity;\r\n      -webkit-animation:grow 4s infinite;\r\n      img{\r\n        width: 50px;\r\n      }\r\n    }\r\n    #loader {\r\n      display: block;\r\n      position: relative;\r\n      top: 0;\r\n      left: 0;\r\n      background: linear-gradient(90deg,black,#EFD15B,  #EFD15B,#EFD15B, black);\r\n      background-size: 400% 100%;\r\n      width: 400%;\r\n      height: 15px;\r\n      background-repeat: no-repeat;\r\n      -webkit-animation: AnimationName 5s ease infinite;\r\n      -moz-animation: AnimationName 5s ease infinite;\r\n      animation: AnimationName 5s ease infinite;\r\n    }\r\n  }\r\n  #loading-screen.fade-out {\r\n    opacity: 0;\r\n  }\r\n  li{\r\n    color: black;\r\n  }\r\n  #blocker {\r\n    position: absolute;\r\n    width: 100%;\r\n    height: 100%;\r\n    background-color: rgba(0,0,0,1);\r\n    z-index: 2;\r\n    transition: all 0.5s ease;\r\n    #instructions {\r\n      width: 100%;\r\n      height: 100%;\r\n      display: -webkit-flex;\r\n      display: -moz-flex;\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      flex-direction: column;\r\n      color: #ffffff;\r\n      text-align: center;\r\n      cursor: pointer;\r\n    }\r\n  }\r\n  .controls {\r\n    z-index: 1000;\r\n    position: absolute;\r\n    bottom: 0;\r\n    left: 0;\r\n    margin:0;\r\n    padding: 0;\r\n  }\r\n  .container{\r\n    .wrapper{\r\n      margin: 40px;\r\n      .left-down{\r\n        position: fixed;\r\n        bottom: 0;\r\n        left: 0;\r\n      }\r\n      .right-down{\r\n        position: fixed;\r\n        bottom: 0;\r\n        right: 0;\r\n      }\r\n      .top-right{\r\n        position: fixed;\r\n        top: 0;\r\n        right: 0;\r\n      }\r\n      .center-down{\r\n        position: fixed;\r\n        bottom: 0;\r\n        margin: auto;\r\n        left: calc(50% - 20px);\r\n        .mouse {\r\n          bottom: 0;\r\n          width: 40px;\r\n          height: 60px;\r\n          border-radius: 20px;\r\n          border: 3px solid #EFD15B;\r\n        }\r\n        .mouse:before, .mouse:after {\r\n          content: \"\";\r\n          display: block;\r\n          position: absolute;\r\n        }\r\n        /* Second */\r\n        .m-1:before {\r\n          width: 10px;\r\n          height: 10px;\r\n          border-radius: 50%;\r\n          top: 10px;\r\n          left: calc(50% - 5px);\r\n          background: #EFD15B;\r\n          -webkit-animation: m-1-ball 1.2s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;\r\n                  animation: m-1-ball 1.2s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;\r\n        }\r\n      }\r\n      .center{\r\n        .marker{\r\n          width:50px;\r\n          height: 50px;\r\n          // background: red;\r\n          position: absolute;\r\n          top: 0;\r\n          left: 0;\r\n          right: 0;\r\n          bottom: 0;\r\n          margin: auto;\r\n          z-index: 1;\r\n          display: flex;\r\n          &:before, &:after{\r\n            position: absolute;\r\n            content: '';\r\n          }\r\n          &:before{\r\n            /* Permalink - use to edit and share this gradient: https://colorzilla.com/gradient-editor/#efd15b+0,efd15b+100&1+0,0+40,0+60,1+100 */\r\n            background: -moz-linear-gradient(top,  rgba(239,209,91,1) 0%, rgba(239,209,91,0) 40%, rgba(239,209,91,0) 60%, rgba(239,209,91,1) 100%); /* FF3.6-15 */\r\n            background: -webkit-linear-gradient(top,  rgba(239,209,91,1) 0%,rgba(239,209,91,0) 40%,rgba(239,209,91,0) 60%,rgba(239,209,91,1) 100%); /* Chrome10-25,Safari5.1-6 */\r\n            background: linear-gradient(to bottom,  rgba(239,209,91,1) 0%,rgba(239,209,91,0) 40%,rgba(239,209,91,0) 60%,rgba(239,209,91,1) 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */\r\n            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#efd15b', endColorstr='#efd15b',GradientType=0 ); /* IE6-9 */\r\n            height: 50px;\r\n            width: 2px;\r\n            margin:auto;\r\n            position:absolute;\r\n            left:0;right:0;\r\n          }\r\n          &:after{\r\n            width:50px;\r\n            background: -moz-linear-gradient(left,  rgba(239,209,91,1) 0%, rgba(239,209,91,0) 40%, rgba(239,209,91,0) 60%, rgba(239,209,91,1) 100%); /* FF3.6-15 */\r\n            background: -webkit-linear-gradient(left,  rgba(239,209,91,1) 0%,rgba(239,209,91,0) 40%,rgba(239,209,91,0) 60%,rgba(239,209,91,1) 100%); /* Chrome10-25,Safari5.1-6 */\r\n            background: linear-gradient(to right,  rgba(239,209,91,1) 0%,rgba(239,209,91,0) 40%,rgba(239,209,91,0) 60%,rgba(239,209,91,1) 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */\r\n            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#efd15b', endColorstr='#efd15b',GradientType=1 ); /* IE6-9 */\r\n            height:2px;\r\n            margin:auto;\r\n            position:absolute;\r\n            top:0;bottom:0;\r\n          }\r\n        }\r\n      }\r\n    } \r\n  }\r\n}\r\n.fade-enter-active, .fade-leave-active {\r\n  transition: opacity .5s;\r\n}\r\n.fade-enter, .fade-leave-to /* .fade-leave-active below version 2.1.8 */ {\r\n  opacity: 0;\r\n}\r\n\r\n@-webkit-keyframes AnimationName {\r\n  0%{background-position:0% 50%}\r\n  50%{background-position:125% 50%}\r\n  100%{background-position:0% 50%}\r\n}\r\n@-moz-keyframes AnimationName {\r\n  0%{background-position:0% 50%}\r\n  50%{background-position:125% 50%}\r\n  100%{background-position:0% 50%}\r\n}\r\n@keyframes AnimationName {\r\n  0%{background-position:0% 50%}\r\n  50%{background-position:125% 50%}\r\n  100%{background-position:0% 50%}\r\n}\r\n\r\n\r\n@-webkit-keyframes grow {\r\n  0% {-webkit-transform: scale( 0.8 );-moz-transform: scale( 0.8 );-o-transform: scale( 0.8 );-ms-transform: scale( 0.8 );transform: scale( 0.8 );}\r\n  50% {-webkit-transform: scale( 1 );-moz-transform: scale( 1 );-o-transform: scale( 1 );-ms-transform: scale( 1 );transform: scale( 1 );}\r\n  100% {-webkit-transform: scale( 0.8 );-moz-transform: scale( 0.8 );-o-transform: scale( 0.8 );-ms-transform: scale( 0.8 );transform: scale( 0.8 );}\r\n}\r\n\r\n\r\n@-webkit-keyframes m-1-ball {\r\n  0%, 65%, 100% {\r\n    opacity: 0;\r\n  }\r\n  10%, 40% {\r\n    opacity: 1;\r\n  }\r\n  0% {\r\n    -webkit-transform: translateY(5px) scale(0.7);\r\n            transform: translateY(5px) scale(0.7);\r\n  }\r\n  5% {\r\n    -webkit-transform: scale(0.7);\r\n            transform: scale(0.7);\r\n  }\r\n  15%, 100% {\r\n    -webkit-transform: scale(1);\r\n            transform: scale(1);\r\n  }\r\n  45%, 65% {\r\n    -webkit-transform: translateY(24px) scale(0.7);\r\n            transform: translateY(24px) scale(0.7);\r\n  }\r\n}\r\n\r\n@keyframes m-1-ball {\r\n  0%, 65%, 100% {\r\n    opacity: 0;\r\n  }\r\n  10%, 40% {\r\n    opacity: 1;\r\n  }\r\n  0% {\r\n    -webkit-transform: translateY(5px) scale(0.7);\r\n            transform: translateY(5px) scale(0.7);\r\n  }\r\n  5% {\r\n    -webkit-transform: scale(0.7);\r\n            transform: scale(0.7);\r\n  }\r\n  15%, 100% {\r\n    -webkit-transform: scale(1);\r\n            transform: scale(1);\r\n  }\r\n  45%, 65% {\r\n    -webkit-transform: translateY(24px) scale(0.7);\r\n            transform: translateY(24px) scale(0.7);\r\n  }\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Play.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Play.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Play.vue?vue&type=template&id=60cb8962&scoped=true&\"\nimport script from \"./Play.vue?vue&type=script&lang=js&\"\nexport * from \"./Play.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Play.vue?vue&type=style&index=0&id=60cb8962&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"60cb8962\",\n  null\n  \n)\n\nexport default component.exports","/**\n * @author mrdoob / http://mrdoob.com/\n * Source: https://github.com/mrdoob/three.js/blob/master/examples/js/controls/PointerLockControls.js\n *\n * Adopted to common js by Javier Zapata\n */\n\nmodule.exports = function ( camera ) {\n\n  var THREE = window.THREE || require('three');\n\n  var scope = this;\n\n  camera.rotation.set( 0, 0, 0 );\n\n  var pitchObject = new THREE.Object3D();\n  pitchObject.add( camera );\n\n  var yawObject = new THREE.Object3D();\n  yawObject.position.y = 10;\n  yawObject.add( pitchObject );\n\n  var moveForward = false;\n  var moveBackward = false;\n  var moveLeft = false;\n  var moveRight = false;\n\n  var isOnObject = false;\n  var canJump = false;\n\n  var prevTime = performance.now();\n\n  var velocity = new THREE.Vector3();\n\n  var PI_2 = Math.PI / 2;\n\n  var onMouseMove = function ( event ) {\n\n    if ( scope.enabled === false ) return;\n\n    var movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;\n    var movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;\n\n    yawObject.rotation.y -= movementX * 0.002;\n    pitchObject.rotation.x -= movementY * 0.002;\n\n    pitchObject.rotation.x = Math.max( - PI_2, Math.min( PI_2, pitchObject.rotation.x ) );\n\n  };\n\n  var onKeyDown = function ( event ) {\n\n    switch ( event.keyCode ) {\n\n      case 38: // up\n      case 87: // w\n        moveForward = true;\n        break;\n\n      case 37: // left\n      case 65: // a\n        moveLeft = true; break;\n\n      case 40: // down\n      case 83: // s\n        moveBackward = true;\n        break;\n\n      case 39: // right\n      case 68: // d\n        moveRight = true;\n        break;\n\n      case 32: // space\n        if ( canJump === true ) velocity.y += 350;\n        canJump = false;\n        break;\n\n    }\n\n  };\n\n  var onKeyUp = function ( event ) {\n\n    switch( event.keyCode ) {\n\n      case 38: // up\n      case 87: // w\n        moveForward = false;\n        break;\n\n      case 37: // left\n      case 65: // a\n        moveLeft = false;\n        break;\n\n      case 40: // down\n      case 83: // s\n        moveBackward = false;\n        break;\n\n      case 39: // right\n      case 68: // d\n        moveRight = false;\n        break;\n\n    }\n\n  };\n\n  document.addEventListener( 'mousemove', onMouseMove, false );\n  document.addEventListener( 'keydown', onKeyDown, false );\n  document.addEventListener( 'keyup', onKeyUp, false );\n\n  this.enabled = false;\n\n  this.getObject = function () {\n\n    return yawObject;\n\n  };\n\n  this.isOnObject = function ( boolean ) {\n\n    isOnObject = boolean;\n    canJump = boolean;\n\n  };\n\n  this.getDirection = function() {\n\n    // assumes the camera itself is not rotated\n\n    var direction = new THREE.Vector3( 0, 0, -1 );\n    var rotation = new THREE.Euler( 0, 0, 0, \"YXZ\" );\n\n    return function( v ) {\n\n      rotation.set( pitchObject.rotation.x, yawObject.rotation.y, 0 );\n\n      v.copy( direction ).applyEuler( rotation );\n\n      return v;\n\n    };\n\n  }();\n\n  this.update = function () {\n\n    if ( scope.enabled === false ) return;\n\n    var time = performance.now();\n    var delta = ( time - prevTime ) / 1000;\n\n    velocity.x -= velocity.x * 10.0 * delta;\n    velocity.z -= velocity.z * 10.0 * delta;\n\n    velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\n\n    if ( moveForward ) velocity.z -= 400.0 * delta;\n    if ( moveBackward ) velocity.z += 400.0 * delta;\n\n    if ( moveLeft ) velocity.x -= 400.0 * delta;\n    if ( moveRight ) velocity.x += 400.0 * delta;\n\n    if ( isOnObject === true ) {\n      velocity.y = Math.max( 0, velocity.y );\n    }\n\n    yawObject.translateX( velocity.x * delta );\n    yawObject.translateY( velocity.y * delta );\n    yawObject.translateZ( velocity.z * delta );\n\n    if ( yawObject.position.y < 10 ) {\n\n      velocity.y = 0;\n      yawObject.position.y = 10;\n\n      canJump = true;\n    }\n\n    prevTime = time;\n  };\n};\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Play.vue?vue&type=style&index=0&id=60cb8962&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Play.vue?vue&type=style&index=0&id=60cb8962&lang=scss&scoped=true&\"","module.exports = __webpack_public_path__ + \"img/lock.ae7ad660.svg\";","module.exports = __webpack_public_path__ + \"img/lock.9fe83a15.png\";","var THREE = require( 'three' );\n\n/**\n* @author Tim Knip / http://www.floorplanner.com/ / tim at floorplanner.com\n* @author Tony Parisi / http://www.tonyparisi.com/\n*/\n\nvar ColladaLoader = function () {\n\n    var COLLADA = null;\n    var scene = null;\n    var visualScene;\n    var kinematicsModel;\n\n    var readyCallbackFunc = null;\n\n    var sources = {};\n    var images = {};\n    var animations = {};\n    var controllers = {};\n    var geometries = {};\n    var materials = {};\n    var effects = {};\n    var cameras = {};\n    var lights = {};\n\n    var animData;\n    var kinematics;\n    var visualScenes;\n    var kinematicsModels;\n    var baseUrl;\n    var morphs;\n    var skins;\n\n    var flip_uv = true;\n    var preferredShading = THREE.SmoothShading;\n\n    var options = {\n        // Force Geometry to always be centered at the local origin of the\n        // containing Mesh.\n        centerGeometry: false,\n\n        // Axis conversion is done for geometries, animations, and controllers.\n        // If we ever pull cameras or lights out of the COLLADA file, they'll\n        // need extra work.\n        convertUpAxis: false,\n\n        subdivideFaces: true,\n\n        upAxis: 'Y',\n\n        // For reflective or refractive materials we'll use this cubemap\n        defaultEnvMap: null\n\n    };\n\n    var colladaUnit = 1.0;\n    var colladaUp = 'Y';\n    var upConversion = null;\n\n    function load ( url, readyCallback, progressCallback, failCallback ) {\n\n        var length = 0;\n\n        if ( document.implementation && document.implementation.createDocument ) {\n\n            var request = new XMLHttpRequest();\n\n            request.onreadystatechange = function() {\n\n                if ( request.readyState === 4 ) {\n\n                    if ( request.status === 0 || request.status === 200 ) {\n\n                        if ( request.response ) {\n\n                            readyCallbackFunc = readyCallback;\n                            parse( request.response, undefined, url );\n\n                        } else {\n\n                            if ( failCallback ) {\n\n                                failCallback();\n\n                            } else {\n\n                                console.error( \"ColladaLoader: Empty or non-existing file (\" + url + \")\" );\n\n                            }\n\n                        }\n\n                    }\n\n                } else if ( request.readyState === 3 ) {\n\n                    if ( progressCallback ) {\n\n                        if ( length === 0 ) {\n\n                            length = request.getResponseHeader( \"Content-Length\" );\n\n                        }\n\n                        progressCallback( { total: length, loaded: request.responseText.length } );\n\n                    }\n\n                }\n\n            };\n\n            request.open( \"GET\", url, true );\n            request.send( null );\n\n        } else {\n\n            alert( \"Don't know how to parse XML!\" );\n\n        }\n\n    }\n\n    function parse( text, callBack, url ) {\n\n        COLLADA = new DOMParser().parseFromString( text, 'text/xml' );\n        callBack = callBack || readyCallbackFunc;\n\n        if ( url !== undefined ) {\n\n            var parts = url.split( '/' );\n            parts.pop();\n            baseUrl = ( parts.length < 1 ? '.' : parts.join( '/' ) ) + '/';\n\n        }\n\n        parseAsset();\n        setUpConversion();\n        images = parseLib( \"library_images image\", _Image, \"image\" );\n        materials = parseLib( \"library_materials material\", Material, \"material\" );\n        effects = parseLib( \"library_effects effect\", Effect, \"effect\" );\n        geometries = parseLib( \"library_geometries geometry\", Geometry, \"geometry\" );\n        cameras = parseLib( \"library_cameras camera\", Camera, \"camera\" );\n        lights = parseLib( \"library_lights light\", Light, \"light\" );\n        controllers = parseLib( \"library_controllers controller\", Controller, \"controller\" );\n        animations = parseLib( \"library_animations animation\", Animation, \"animation\" );\n        visualScenes = parseLib( \"library_visual_scenes visual_scene\", VisualScene, \"visual_scene\" );\n        kinematicsModels = parseLib( \"library_kinematics_models kinematics_model\", KinematicsModel, \"kinematics_model\" );\n\n        morphs = [];\n        skins = [];\n\n        visualScene = parseScene();\n        scene = new THREE.Group();\n\n        for ( var i = 0; i < visualScene.nodes.length; i ++ ) {\n\n            scene.add( createSceneGraph( visualScene.nodes[ i ] ) );\n\n        }\n\n        // unit conversion\n        scene.scale.multiplyScalar( colladaUnit );\n\n        createAnimations();\n\n        kinematicsModel = parseKinematicsModel();\n        createKinematics();\n\n        var result = {\n\n            scene: scene,\n            morphs: morphs,\n            skins: skins,\n            animations: animData,\n            kinematics: kinematics,\n            dae: {\n                images: images,\n                materials: materials,\n                cameras: cameras,\n                lights: lights,\n                effects: effects,\n                geometries: geometries,\n                controllers: controllers,\n                animations: animations,\n                visualScenes: visualScenes,\n                visualScene: visualScene,\n                scene: visualScene,\n                kinematicsModels: kinematicsModels,\n                kinematicsModel: kinematicsModel\n            }\n\n        };\n\n        if ( callBack ) {\n\n            callBack( result );\n\n        }\n\n        return result;\n\n    }\n\n    function setPreferredShading ( shading ) {\n\n        preferredShading = shading;\n\n    }\n\n    function parseAsset () {\n\n        var elements = COLLADA.querySelectorAll('asset');\n\n        var element = elements[0];\n\n        if ( element && element.childNodes ) {\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n\n                switch ( child.nodeName ) {\n\n                    case 'unit':\n\n                        var meter = child.getAttribute( 'meter' );\n\n                        if ( meter ) {\n\n                            colladaUnit = parseFloat( meter );\n\n                        }\n\n                        break;\n\n                    case 'up_axis':\n\n                        colladaUp = child.textContent.charAt(0);\n                        break;\n\n                }\n\n            }\n\n        }\n\n    }\n\n    function parseLib ( q, classSpec, prefix ) {\n\n        var elements = COLLADA.querySelectorAll(q);\n\n        var lib = {};\n\n        var i = 0;\n\n        var elementsLength = elements.length;\n\n        for ( var j = 0; j < elementsLength; j ++ ) {\n\n            var element = elements[j];\n            var daeElement = ( new classSpec() ).parse( element );\n\n            if ( !daeElement.id || daeElement.id.length === 0 ) daeElement.id = prefix + ( i ++ );\n            lib[ daeElement.id ] = daeElement;\n\n        }\n\n        return lib;\n\n    }\n\n    function parseScene() {\n\n        var sceneElement = COLLADA.querySelectorAll('scene instance_visual_scene')[0];\n\n        if ( sceneElement ) {\n\n            var url = sceneElement.getAttribute( 'url' ).replace( /^#/, '' );\n            return visualScenes[ url.length > 0 ? url : 'visual_scene0' ];\n\n        } else {\n\n            return null;\n\n        }\n\n    }\n\n    function parseKinematicsModel() {\n\n        var kinematicsModelElement = COLLADA.querySelectorAll('instance_kinematics_model')[0];\n\n        if ( kinematicsModelElement ) {\n\n            var url = kinematicsModelElement.getAttribute( 'url' ).replace(/^#/, '');\n            return kinematicsModels[ url.length > 0 ? url : 'kinematics_model0' ];\n\n        } else {\n\n            return null;\n\n        }\n\n    }\n\n    function createAnimations() {\n\n        animData = [];\n\n        // fill in the keys\n        recurseHierarchy( scene );\n\n    }\n\n    function recurseHierarchy( node ) {\n\n        var n = visualScene.getChildById( node.colladaId, true ),\n            newData = null;\n\n        if ( n && n.keys ) {\n\n            newData = {\n                fps: 60,\n                hierarchy: [ {\n                    node: n,\n                    keys: n.keys,\n                    sids: n.sids\n                } ],\n                node: node,\n                name: 'animation_' + node.name,\n                length: 0\n            };\n\n            animData.push(newData);\n\n            for ( var i = 0, il = n.keys.length; i < il; i ++ ) {\n\n                newData.length = Math.max( newData.length, n.keys[i].time );\n\n            }\n\n        } else {\n\n            newData = {\n                hierarchy: [ {\n                    keys: [],\n                    sids: []\n                } ]\n            }\n\n        }\n\n        for ( var i = 0, il = node.children.length; i < il; i ++ ) {\n\n            var d = recurseHierarchy( node.children[i] );\n\n            for ( var j = 0, jl = d.hierarchy.length; j < jl; j ++ ) {\n\n                newData.hierarchy.push( {\n                    keys: [],\n                    sids: []\n                } );\n\n            }\n\n        }\n\n        return newData;\n\n    }\n\n    function calcAnimationBounds () {\n\n        var start = 1000000;\n        var end = -start;\n        var frames = 0;\n        var ID;\n        for ( var id in animations ) {\n\n            var animation = animations[ id ];\n            ID = ID || animation.id;\n            for ( var i = 0; i < animation.sampler.length; i ++ ) {\n\n                var sampler = animation.sampler[ i ];\n\n                sampler.create();\n\n                start = Math.min( start, sampler.startTime );\n                end = Math.max( end, sampler.endTime );\n                frames = Math.max( frames, sampler.input.length );\n\n            }\n\n        }\n\n        return { start:start, end:end, frames:frames,ID:ID };\n\n    }\n\n    function createMorph ( geometry, ctrl ) {\n\n        var morphCtrl = ctrl instanceof InstanceController ? controllers[ ctrl.url ] : ctrl;\n\n        if ( !morphCtrl || !morphCtrl.morph ) {\n\n            console.log(\"could not find morph controller!\");\n            return;\n\n        }\n\n        var morph = morphCtrl.morph;\n\n        for ( var i = 0; i < morph.targets.length; i ++ ) {\n\n            var target_id = morph.targets[ i ];\n            var daeGeometry = geometries[ target_id ];\n\n            if ( !daeGeometry.mesh ||\n                 !daeGeometry.mesh.primitives ||\n                 !daeGeometry.mesh.primitives.length ) {\n                 continue;\n            }\n\n            var target = daeGeometry.mesh.primitives[ 0 ].geometry;\n\n            if ( target.vertices.length === geometry.vertices.length ) {\n\n                geometry.morphTargets.push( { name: \"target_1\", vertices: target.vertices } );\n\n            }\n\n        }\n\n        geometry.morphTargets.push( { name: \"target_Z\", vertices: geometry.vertices } );\n\n    }\n\n    function createSkin ( geometry, ctrl, applyBindShape ) {\n\n        var skinCtrl = controllers[ ctrl.url ];\n\n        if ( !skinCtrl || !skinCtrl.skin ) {\n\n            console.log( \"could not find skin controller!\" );\n            return;\n\n        }\n\n        if ( !ctrl.skeleton || !ctrl.skeleton.length ) {\n\n            console.log( \"could not find the skeleton for the skin!\" );\n            return;\n\n        }\n\n        var skin = skinCtrl.skin;\n        var skeleton = visualScene.getChildById( ctrl.skeleton[ 0 ] );\n        var hierarchy = [];\n\n        applyBindShape = applyBindShape !== undefined ? applyBindShape : true;\n\n        var bones = [];\n        geometry.skinWeights = [];\n        geometry.skinIndices = [];\n\n        //createBones( geometry.bones, skin, hierarchy, skeleton, null, -1 );\n        //createWeights( skin, geometry.bones, geometry.skinIndices, geometry.skinWeights );\n\n        /*\n        geometry.animation = {\n            name: 'take_001',\n            fps: 30,\n            length: 2,\n            JIT: true,\n            hierarchy: hierarchy\n        };\n        */\n\n        if ( applyBindShape ) {\n\n            for ( var i = 0; i < geometry.vertices.length; i ++ ) {\n\n                geometry.vertices[ i ].applyMatrix4( skin.bindShapeMatrix );\n\n            }\n\n        }\n\n    }\n\n    function setupSkeleton ( node, bones, frame, parent ) {\n\n        node.world = node.world || new THREE.Matrix4();\n        node.localworld = node.localworld || new THREE.Matrix4();\n        node.world.copy( node.matrix );\n        node.localworld.copy( node.matrix );\n\n        if ( node.channels && node.channels.length ) {\n\n            var channel = node.channels[ 0 ];\n            var m = channel.sampler.output[ frame ];\n\n            if ( m instanceof THREE.Matrix4 ) {\n\n                node.world.copy( m );\n                node.localworld.copy(m);\n                if (frame === 0)\n                    node.matrix.copy(m);\n            }\n\n        }\n\n        if ( parent ) {\n\n            node.world.multiplyMatrices( parent, node.world );\n\n        }\n\n        bones.push( node );\n\n        for ( var i = 0; i < node.nodes.length; i ++ ) {\n\n            setupSkeleton( node.nodes[ i ], bones, frame, node.world );\n\n        }\n\n    }\n\n    function setupSkinningMatrices ( bones, skin ) {\n\n        // FIXME: this is dumb...\n\n        for ( var i = 0; i < bones.length; i ++ ) {\n\n            var bone = bones[ i ];\n            var found = -1;\n\n            if ( bone.type != 'JOINT' ) continue;\n\n            for ( var j = 0; j < skin.joints.length; j ++ ) {\n\n                if ( bone.sid === skin.joints[ j ] ) {\n\n                    found = j;\n                    break;\n\n                }\n\n            }\n\n            if ( found >= 0 ) {\n\n                var inv = skin.invBindMatrices[ found ];\n\n                bone.invBindMatrix = inv;\n                bone.skinningMatrix = new THREE.Matrix4();\n                bone.skinningMatrix.multiplyMatrices(bone.world, inv); // (IBMi * JMi)\n                bone.animatrix = new THREE.Matrix4();\n\n                bone.animatrix.copy(bone.localworld);\n                bone.weights = [];\n\n                for ( var j = 0; j < skin.weights.length; j ++ ) {\n\n                    for (var k = 0; k < skin.weights[ j ].length; k ++ ) {\n\n                        var w = skin.weights[ j ][ k ];\n\n                        if ( w.joint === found ) {\n\n                            bone.weights.push( w );\n\n                        }\n\n                    }\n\n                }\n\n            } else {\n\n                console.warn( \"ColladaLoader: Could not find joint '\" + bone.sid + \"'.\" );\n\n                bone.skinningMatrix = new THREE.Matrix4();\n                bone.weights = [];\n\n            }\n        }\n\n    }\n\n    //Walk the Collada tree and flatten the bones into a list, extract the position, quat and scale from the matrix\n    function flattenSkeleton(skeleton) {\n\n        var list = [];\n        var walk = function(parentid, node, list) {\n\n            var bone = {};\n            bone.name = node.sid;\n            bone.parent = parentid;\n            bone.matrix = node.matrix;\n            var data = [ new THREE.Vector3(),new THREE.Quaternion(),new THREE.Vector3() ];\n            bone.matrix.decompose(data[0], data[1], data[2]);\n\n            bone.pos = [ data[0].x,data[0].y,data[0].z ];\n\n            bone.scl = [ data[2].x,data[2].y,data[2].z ];\n            bone.rotq = [ data[1].x,data[1].y,data[1].z,data[1].w ];\n            list.push(bone);\n\n            for (var i in node.nodes) {\n\n                walk(node.sid, node.nodes[i], list);\n\n            }\n\n        };\n\n        walk(-1, skeleton, list);\n        return list;\n\n    }\n\n    //Move the vertices into the pose that is proper for the start of the animation\n    function skinToBindPose(geometry,skeleton,skinController) {\n\n        var bones = [];\n        setupSkeleton( skeleton, bones, -1 );\n        setupSkinningMatrices( bones, skinController.skin );\n        var v = new THREE.Vector3();\n        var skinned = [];\n\n        for (var i = 0; i < geometry.vertices.length; i ++) {\n\n            skinned.push(new THREE.Vector3());\n\n        }\n\n        for ( i = 0; i < bones.length; i ++ ) {\n\n            if ( bones[ i ].type != 'JOINT' ) continue;\n\n            for ( var j = 0; j < bones[ i ].weights.length; j ++ ) {\n\n                var w = bones[ i ].weights[ j ];\n                var vidx = w.index;\n                var weight = w.weight;\n\n                var o = geometry.vertices[vidx];\n                var s = skinned[vidx];\n\n                v.x = o.x;\n                v.y = o.y;\n                v.z = o.z;\n\n                v.applyMatrix4( bones[i].skinningMatrix );\n\n                s.x += (v.x * weight);\n                s.y += (v.y * weight);\n                s.z += (v.z * weight);\n            }\n\n        }\n\n        for (var i = 0; i < geometry.vertices.length; i ++) {\n\n            geometry.vertices[i] = skinned[i];\n\n        }\n\n    }\n\n    function applySkin ( geometry, instanceCtrl, frame ) {\n\n        var skinController = controllers[ instanceCtrl.url ];\n\n        frame = frame !== undefined ? frame : 40;\n\n        if ( !skinController || !skinController.skin ) {\n\n            console.log( 'ColladaLoader: Could not find skin controller.' );\n            return;\n\n        }\n\n        if ( !instanceCtrl.skeleton || !instanceCtrl.skeleton.length ) {\n\n            console.log( 'ColladaLoader: Could not find the skeleton for the skin. ' );\n            return;\n\n        }\n\n        var animationBounds = calcAnimationBounds();\n        var skeleton = visualScene.getChildById( instanceCtrl.skeleton[0], true ) || visualScene.getChildBySid( instanceCtrl.skeleton[0], true );\n\n        //flatten the skeleton into a list of bones\n        var bonelist = flattenSkeleton(skeleton);\n        var joints = skinController.skin.joints;\n\n        //sort that list so that the order reflects the order in the joint list\n        var sortedbones = [];\n        for (var i = 0; i < joints.length; i ++) {\n\n            for (var j = 0; j < bonelist.length; j ++) {\n\n                if (bonelist[j].name === joints[i]) {\n\n                    sortedbones[i] = bonelist[j];\n\n                }\n\n            }\n\n        }\n\n        //hook up the parents by index instead of name\n        for (var i = 0; i < sortedbones.length; i ++) {\n\n            for (var j = 0; j < sortedbones.length; j ++) {\n\n                if (sortedbones[i].parent === sortedbones[j].name) {\n\n                    sortedbones[i].parent = j;\n\n                }\n\n            }\n\n        }\n\n\n        var i, j, w, vidx, weight;\n        var v = new THREE.Vector3(), o, s;\n\n        // move vertices to bind shape\n        for ( i = 0; i < geometry.vertices.length; i ++ ) {\n            geometry.vertices[i].applyMatrix4( skinController.skin.bindShapeMatrix );\n        }\n\n        var skinIndices = [];\n        var skinWeights = [];\n        var weights = skinController.skin.weights;\n\n        // hook up the skin weights\n        // TODO - this might be a good place to choose greatest 4 weights\n        for ( var i =0; i < weights.length; i ++ ) {\n\n            var indicies = new THREE.Vector4(weights[i][0] ? weights[i][0].joint : 0,weights[i][1] ? weights[i][1].joint : 0,weights[i][2] ? weights[i][2].joint : 0,weights[i][3] ? weights[i][3].joint : 0);\n            var weight = new THREE.Vector4(weights[i][0] ? weights[i][0].weight : 0,weights[i][1] ? weights[i][1].weight : 0,weights[i][2] ? weights[i][2].weight : 0,weights[i][3] ? weights[i][3].weight : 0);\n\n            skinIndices.push(indicies);\n            skinWeights.push(weight);\n\n        }\n\n        geometry.skinIndices = skinIndices;\n        geometry.skinWeights = skinWeights;\n        geometry.bones = sortedbones;\n        // process animation, or simply pose the rig if no animation\n\n        //create an animation for the animated bones\n        //NOTE: this has no effect when using morphtargets\n        var animationdata = { \"name\":animationBounds.ID,\"fps\":30,\"length\":animationBounds.frames / 30,\"hierarchy\":[] };\n\n        for (var j = 0; j < sortedbones.length; j ++) {\n\n            animationdata.hierarchy.push({ parent:sortedbones[j].parent, name:sortedbones[j].name, keys:[] });\n\n        }\n\n        console.log( 'ColladaLoader:', animationBounds.ID + ' has ' + sortedbones.length + ' bones.' );\n\n\n\n        skinToBindPose(geometry, skeleton, skinController);\n\n\n        for ( frame = 0; frame < animationBounds.frames; frame ++ ) {\n\n            var bones = [];\n            var skinned = [];\n            // process the frame and setup the rig with a fresh\n            // transform, possibly from the bone's animation channel(s)\n\n            setupSkeleton( skeleton, bones, frame );\n            setupSkinningMatrices( bones, skinController.skin );\n\n            for (var i = 0; i < bones.length; i ++) {\n\n                for (var j = 0; j < animationdata.hierarchy.length; j ++) {\n\n                    if (animationdata.hierarchy[j].name === bones[i].sid) {\n\n                        var key = {};\n                        key.time = (frame / 30);\n                        key.matrix = bones[i].animatrix;\n\n                        if (frame === 0)\n                            bones[i].matrix = key.matrix;\n\n                        var data = [ new THREE.Vector3(),new THREE.Quaternion(),new THREE.Vector3() ];\n                        key.matrix.decompose(data[0], data[1], data[2]);\n\n                        key.pos = [ data[0].x,data[0].y,data[0].z ];\n\n                        key.scl = [ data[2].x,data[2].y,data[2].z ];\n                        key.rot = data[1];\n\n                        animationdata.hierarchy[j].keys.push(key);\n\n                    }\n\n                }\n\n            }\n\n            geometry.animation = animationdata;\n\n        }\n\n    }\n\n    function createKinematics() {\n\n        if ( kinematicsModel && kinematicsModel.joints.length === 0 ) {\n            kinematics = undefined;\n            return;\n        }\n\n        var jointMap = {};\n\n        var _addToMap = function( jointIndex, parentVisualElement ) {\n\n            var parentVisualElementId = parentVisualElement.getAttribute( 'id' );\n            var colladaNode = visualScene.getChildById( parentVisualElementId, true );\n            var joint = kinematicsModel.joints[ jointIndex ];\n\n            scene.traverse(function( node ) {\n\n                if ( node.colladaId == parentVisualElementId ) {\n\n                    jointMap[ jointIndex ] = {\n                        node: node,\n                        transforms: colladaNode.transforms,\n                        joint: joint,\n                        position: joint.zeroPosition\n                    };\n\n                }\n\n            });\n\n        };\n\n        kinematics = {\n\n            joints: kinematicsModel && kinematicsModel.joints,\n\n            getJointValue: function( jointIndex ) {\n\n                var jointData = jointMap[ jointIndex ];\n\n                if ( jointData ) {\n\n                    return jointData.position;\n\n                } else {\n\n                    console.log( 'getJointValue: joint ' + jointIndex + ' doesn\\'t exist' );\n\n                }\n\n            },\n\n            setJointValue: function( jointIndex, value ) {\n\n                var jointData = jointMap[ jointIndex ];\n\n                if ( jointData ) {\n\n                    var joint = jointData.joint;\n\n                    if ( value > joint.limits.max || value < joint.limits.min ) {\n\n                        console.log( 'setJointValue: joint ' + jointIndex + ' value ' + value + ' outside of limits (min: ' + joint.limits.min + ', max: ' + joint.limits.max + ')' );\n\n                    } else if ( joint.static ) {\n\n                        console.log( 'setJointValue: joint ' + jointIndex + ' is static' );\n\n                    } else {\n\n                        var threejsNode = jointData.node;\n                        var axis = joint.axis;\n                        var transforms = jointData.transforms;\n\n                        var matrix = new THREE.Matrix4();\n\n                        for (i = 0; i < transforms.length; i ++ ) {\n\n                            var transform = transforms[ i ];\n\n                            // kinda ghetto joint detection\n                            if ( transform.sid && transform.sid.indexOf( 'joint' + jointIndex ) !== -1 ) {\n\n                                // apply actual joint value here\n                                switch ( joint.type ) {\n\n                                    case 'revolute':\n\n                                        matrix.multiply( m1.makeRotationAxis( axis, THREE.Math.degToRad(value) ) );\n                                        break;\n\n                                    case 'prismatic':\n\n                                        matrix.multiply( m1.makeTranslation(axis.x * value, axis.y * value, axis.z * value ) );\n                                        break;\n\n                                    default:\n\n                                        console.warn( 'setJointValue: unknown joint type: ' + joint.type );\n                                        break;\n\n                                }\n\n                            } else {\n\n                                var m1 = new THREE.Matrix4();\n\n                                switch ( transform.type ) {\n\n                                    case 'matrix':\n\n                                        matrix.multiply( transform.obj );\n\n                                        break;\n\n                                    case 'translate':\n\n                                        matrix.multiply( m1.makeTranslation( transform.obj.x, transform.obj.y, transform.obj.z ) );\n\n                                        break;\n\n                                    case 'rotate':\n\n                                        matrix.multiply( m1.makeRotationAxis( transform.obj, transform.angle ) );\n\n                                        break;\n\n                                }\n                            }\n                        }\n\n                        // apply the matrix to the threejs node\n                        var elementsFloat32Arr = matrix.elements;\n                        var elements = Array.prototype.slice.call( elementsFloat32Arr );\n\n                        var elementsRowMajor = [\n                            elements[ 0 ],\n                            elements[ 4 ],\n                            elements[ 8 ],\n                            elements[ 12 ],\n                            elements[ 1 ],\n                            elements[ 5 ],\n                            elements[ 9 ],\n                            elements[ 13 ],\n                            elements[ 2 ],\n                            elements[ 6 ],\n                            elements[ 10 ],\n                            elements[ 14 ],\n                            elements[ 3 ],\n                            elements[ 7 ],\n                            elements[ 11 ],\n                            elements[ 15 ]\n                        ];\n\n                        threejsNode.matrix.set.apply( threejsNode.matrix, elementsRowMajor );\n                        threejsNode.matrix.decompose( threejsNode.position, threejsNode.quaternion, threejsNode.scale );\n                    }\n\n                } else {\n\n                    console.log( 'setJointValue: joint ' + jointIndex + ' doesn\\'t exist' );\n\n                }\n\n            }\n\n        };\n\n        var element = COLLADA.querySelector('scene instance_kinematics_scene');\n\n        if ( element ) {\n\n            for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n                var child = element.childNodes[ i ];\n\n                if ( child.nodeType != 1 ) continue;\n\n                switch ( child.nodeName ) {\n\n                    case 'bind_joint_axis':\n\n                        var visualTarget = child.getAttribute( 'target' ).split( '/' ).pop();\n                        var axis = child.querySelector('axis param').textContent;\n                        var jointIndex = parseInt( axis.split( 'joint' ).pop().split( '.' )[0] );\n                        var visualTargetElement = COLLADA.querySelector( '[sid=\"' + visualTarget + '\"]' );\n\n                        if ( visualTargetElement ) {\n                            var parentVisualElement = visualTargetElement.parentElement;\n                            _addToMap(jointIndex, parentVisualElement);\n                        }\n\n                        break;\n\n                    default:\n\n                        break;\n\n                }\n\n            }\n        }\n\n    }\n\n    function createSceneGraph ( node, parent ) {\n\n        var obj = new THREE.Object3D();\n        var skinned = false;\n        var skinController;\n        var morphController;\n        var i, j;\n\n        // FIXME: controllers\n\n        for ( i = 0; i < node.controllers.length; i ++ ) {\n\n            var controller = controllers[ node.controllers[ i ].url ];\n\n            switch ( controller.type ) {\n\n                case 'skin':\n\n                    if ( geometries[ controller.skin.source ] ) {\n\n                        var inst_geom = new InstanceGeometry();\n\n                        inst_geom.url = controller.skin.source;\n                        inst_geom.instance_material = node.controllers[ i ].instance_material;\n\n                        node.geometries.push( inst_geom );\n                        skinned = true;\n                        skinController = node.controllers[ i ];\n\n                    } else if ( controllers[ controller.skin.source ] ) {\n\n                        // urgh: controller can be chained\n                        // handle the most basic case...\n\n                        var second = controllers[ controller.skin.source ];\n                        morphController = second;\n                    //\tskinController = node.controllers[i];\n\n                        if ( second.morph && geometries[ second.morph.source ] ) {\n\n                            var inst_geom = new InstanceGeometry();\n\n                            inst_geom.url = second.morph.source;\n                            inst_geom.instance_material = node.controllers[ i ].instance_material;\n\n                            node.geometries.push( inst_geom );\n\n                        }\n\n                    }\n\n                    break;\n\n                case 'morph':\n\n                    if ( geometries[ controller.morph.source ] ) {\n\n                        var inst_geom = new InstanceGeometry();\n\n                        inst_geom.url = controller.morph.source;\n                        inst_geom.instance_material = node.controllers[ i ].instance_material;\n\n                        node.geometries.push( inst_geom );\n                        morphController = node.controllers[ i ];\n\n                    }\n\n                    console.log( 'ColladaLoader: Morph-controller partially supported.' );\n\n                default:\n                    break;\n\n            }\n\n        }\n\n        // geometries\n\n        var double_sided_materials = {};\n\n        for ( i = 0; i < node.geometries.length; i ++ ) {\n\n            var instance_geometry = node.geometries[i];\n            var instance_materials = instance_geometry.instance_material;\n            var geometry = geometries[ instance_geometry.url ];\n            var used_materials = {};\n            var used_materials_array = [];\n            var num_materials = 0;\n            var first_material;\n\n            if ( geometry ) {\n\n                if ( !geometry.mesh || !geometry.mesh.primitives )\n                    continue;\n\n                if ( obj.name.length === 0 ) {\n\n                    obj.name = geometry.id;\n\n                }\n\n                // collect used fx for this geometry-instance\n\n                if ( instance_materials ) {\n\n                    for ( j = 0; j < instance_materials.length; j ++ ) {\n\n                        var instance_material = instance_materials[ j ];\n                        var mat = materials[ instance_material.target ];\n                        var effect_id = mat.instance_effect.url;\n                        var shader = effects[ effect_id ].shader;\n                        var material3js = shader.material;\n\n                        if ( geometry.doubleSided ) {\n\n                            if ( !( instance_material.symbol in double_sided_materials ) ) {\n\n                                var _copied_material = material3js.clone();\n                                _copied_material.side = THREE.DoubleSide;\n                                double_sided_materials[ instance_material.symbol ] = _copied_material;\n\n                            }\n\n                            material3js = double_sided_materials[ instance_material.symbol ];\n\n                        }\n\n                        material3js.opacity = !material3js.opacity ? 1 : material3js.opacity;\n                        used_materials[ instance_material.symbol ] = num_materials;\n                        used_materials_array.push( material3js );\n                        first_material = material3js;\n                        first_material.name = mat.name === null || mat.name === '' ? mat.id : mat.name;\n                        num_materials ++;\n\n                    }\n\n                }\n\n                var mesh;\n                var material = first_material || new THREE.MeshLambertMaterial( { color: 0xdddddd, side: geometry.doubleSided ? THREE.DoubleSide : THREE.FrontSide } );\n                var geom = geometry.mesh.geometry3js;\n\n                if ( num_materials > 1 ) {\n\n                    material = new THREE.MultiMaterial( used_materials_array );\n\n                }\n\n                if ( skinController !== undefined ) {\n\n\n                    applySkin( geom, skinController );\n\n                    if ( geom.morphTargets.length > 0 ) {\n\n                        material.morphTargets = true;\n                        material.skinning = false;\n\n                    } else {\n\n                        material.morphTargets = false;\n                        material.skinning = true;\n\n                    }\n\n\n                    mesh = new THREE.SkinnedMesh( geom, material, false );\n\n\n                    //mesh.skeleton = skinController.skeleton;\n                    //mesh.skinController = controllers[ skinController.url ];\n                    //mesh.skinInstanceController = skinController;\n                    mesh.name = 'skin_' + skins.length;\n\n\n\n                    //mesh.animationHandle.setKey(0);\n                    skins.push( mesh );\n\n                } else if ( morphController !== undefined ) {\n\n                    createMorph( geom, morphController );\n\n                    material.morphTargets = true;\n\n                    mesh = new THREE.Mesh( geom, material );\n                    mesh.name = 'morph_' + morphs.length;\n\n                    morphs.push( mesh );\n\n                } else {\n\n                    if ( geom.isLineStrip === true ) {\n\n                        mesh = new THREE.Line( geom );\n\n                    } else {\n\n                        mesh = new THREE.Mesh( geom, material );\n\n                    }\n\n                }\n\n                obj.add(mesh);\n\n            }\n\n        }\n\n        for ( i = 0; i < node.cameras.length; i ++ ) {\n\n            var instance_camera = node.cameras[i];\n            var cparams = cameras[instance_camera.url];\n\n            var cam = new THREE.PerspectiveCamera(cparams.yfov, parseFloat(cparams.aspect_ratio),\n                    parseFloat(cparams.znear), parseFloat(cparams.zfar));\n\n            obj.add(cam);\n        }\n\n        for ( i = 0; i < node.lights.length; i ++ ) {\n\n            var light = null;\n            var instance_light = node.lights[i];\n            var lparams = lights[instance_light.url];\n\n            if ( lparams && lparams.technique ) {\n\n                var color = lparams.color.getHex();\n                var intensity = lparams.intensity;\n                var distance = lparams.distance;\n                var angle = lparams.falloff_angle;\n\n                switch ( lparams.technique ) {\n\n                    case 'directional':\n\n                        light = new THREE.DirectionalLight( color, intensity, distance );\n                        light.position.set(0, 0, 1);\n                        break;\n\n                    case 'point':\n\n                        light = new THREE.PointLight( color, intensity, distance );\n                        break;\n\n                    case 'spot':\n\n                        light = new THREE.SpotLight( color, intensity, distance, angle );\n                        light.position.set(0, 0, 1);\n                        break;\n\n                    case 'ambient':\n\n                        light = new THREE.AmbientLight( color );\n                        break;\n\n                }\n\n            }\n\n            if (light) {\n                obj.add(light);\n            }\n        }\n\n        obj.name = node.name || node.id || \"\";\n        obj.colladaId = node.id || \"\";\n        obj.layer = node.layer || \"\";\n        obj.matrix = node.matrix;\n        obj.matrix.decompose( obj.position, obj.quaternion, obj.scale );\n\n        if ( options.centerGeometry && obj.geometry ) {\n\n            var delta = obj.geometry.center();\n            delta.multiply( obj.scale );\n            delta.applyQuaternion( obj.quaternion );\n\n            obj.position.sub( delta );\n\n        }\n\n        for ( i = 0; i < node.nodes.length; i ++ ) {\n\n            obj.add( createSceneGraph( node.nodes[i], node ) );\n\n        }\n\n        return obj;\n\n    }\n\n    function getJointId( skin, id ) {\n\n        for ( var i = 0; i < skin.joints.length; i ++ ) {\n\n            if ( skin.joints[ i ] === id ) {\n\n                return i;\n\n            }\n\n        }\n\n    }\n\n    function getLibraryNode( id ) {\n\n        var nodes = COLLADA.querySelectorAll('library_nodes node');\n\n        for ( var i = 0; i < nodes.length; i++ ) {\n\n            var attObj = nodes[i].attributes.getNamedItem('id');\n\n            if ( attObj && attObj.value === id ) {\n\n                return nodes[i];\n\n            }\n\n        }\n\n        return undefined;\n\n    }\n\n    function getChannelsForNode ( node ) {\n\n        var channels = [];\n        var startTime = 1000000;\n        var endTime = -1000000;\n\n        for ( var id in animations ) {\n\n            var animation = animations[id];\n\n            for ( var i = 0; i < animation.channel.length; i ++ ) {\n\n                var channel = animation.channel[i];\n                var sampler = animation.sampler[i];\n                var id = channel.target.split('/')[0];\n\n                if ( id == node.id ) {\n\n                    sampler.create();\n                    channel.sampler = sampler;\n                    startTime = Math.min(startTime, sampler.startTime);\n                    endTime = Math.max(endTime, sampler.endTime);\n                    channels.push(channel);\n\n                }\n\n            }\n\n        }\n\n        if ( channels.length ) {\n\n            node.startTime = startTime;\n            node.endTime = endTime;\n\n        }\n\n        return channels;\n\n    }\n\n    function calcFrameDuration( node ) {\n\n        var minT = 10000000;\n\n        for ( var i = 0; i < node.channels.length; i ++ ) {\n\n            var sampler = node.channels[i].sampler;\n\n            for ( var j = 0; j < sampler.input.length - 1; j ++ ) {\n\n                var t0 = sampler.input[ j ];\n                var t1 = sampler.input[ j + 1 ];\n                minT = Math.min( minT, t1 - t0 );\n\n            }\n        }\n\n        return minT;\n\n    }\n\n    function calcMatrixAt( node, t ) {\n\n        var animated = {};\n\n        var i, j;\n\n        for ( i = 0; i < node.channels.length; i ++ ) {\n\n            var channel = node.channels[ i ];\n            animated[ channel.sid ] = channel;\n\n        }\n\n        var matrix = new THREE.Matrix4();\n\n        for ( i = 0; i < node.transforms.length; i ++ ) {\n\n            var transform = node.transforms[ i ];\n            var channel = animated[ transform.sid ];\n\n            if ( channel !== undefined ) {\n\n                var sampler = channel.sampler;\n                var value;\n\n                for ( j = 0; j < sampler.input.length - 1; j ++ ) {\n\n                    if ( sampler.input[ j + 1 ] > t ) {\n\n                        value = sampler.output[ j ];\n                        //console.log(value.flatten)\n                        break;\n\n                    }\n\n                }\n\n                if ( value !== undefined ) {\n\n                    if ( value instanceof THREE.Matrix4 ) {\n\n                        matrix.multiplyMatrices( matrix, value );\n\n                    } else {\n\n                        // FIXME: handle other types\n\n                        matrix.multiplyMatrices( matrix, transform.matrix );\n\n                    }\n\n                } else {\n\n                    matrix.multiplyMatrices( matrix, transform.matrix );\n\n                }\n\n            } else {\n\n                matrix.multiplyMatrices( matrix, transform.matrix );\n\n            }\n\n        }\n\n        return matrix;\n\n    }\n\n    function bakeAnimations ( node ) {\n\n        if ( node.channels && node.channels.length ) {\n\n            var keys = [],\n                sids = [];\n\n            for ( var i = 0, il = node.channels.length; i < il; i ++ ) {\n\n                var channel = node.channels[i],\n                    fullSid = channel.fullSid,\n                    sampler = channel.sampler,\n                    input = sampler.input,\n                    transform = node.getTransformBySid( channel.sid ),\n                    member;\n\n                if ( channel.arrIndices ) {\n\n                    member = [];\n\n                    for ( var j = 0, jl = channel.arrIndices.length; j < jl; j ++ ) {\n\n                        member[ j ] = getConvertedIndex( channel.arrIndices[ j ] );\n\n                    }\n\n                } else {\n\n                    member = getConvertedMember( channel.member );\n\n                }\n\n                if ( transform ) {\n\n                    if ( sids.indexOf( fullSid ) === -1 ) {\n\n                        sids.push( fullSid );\n\n                    }\n\n                    for ( var j = 0, jl = input.length; j < jl; j ++ ) {\n\n                        var time = input[j],\n                            data = sampler.getData( transform.type, j, member ),\n                            key = findKey( keys, time );\n\n                        if ( !key ) {\n\n                            key = new Key( time );\n                            var timeNdx = findTimeNdx( keys, time );\n                            keys.splice( timeNdx === -1 ? keys.length : timeNdx, 0, key );\n\n                        }\n\n                        key.addTarget( fullSid, transform, member, data );\n\n                    }\n\n                } else {\n\n                    console.log( 'Could not find transform \"' + channel.sid + '\" in node ' + node.id );\n\n                }\n\n            }\n\n            // post process\n            for ( var i = 0; i < sids.length; i ++ ) {\n\n                var sid = sids[ i ];\n\n                for ( var j = 0; j < keys.length; j ++ ) {\n\n                    var key = keys[ j ];\n\n                    if ( !key.hasTarget( sid ) ) {\n\n                        interpolateKeys( keys, key, j, sid );\n\n                    }\n\n                }\n\n            }\n\n            node.keys = keys;\n            node.sids = sids;\n\n        }\n\n    }\n\n    function findKey ( keys, time) {\n\n        var retVal = null;\n\n        for ( var i = 0, il = keys.length; i < il && retVal === null; i ++ ) {\n\n            var key = keys[i];\n\n            if ( key.time === time ) {\n\n                retVal = key;\n\n            } else if ( key.time > time ) {\n\n                break;\n\n            }\n\n        }\n\n        return retVal;\n\n    }\n\n    function findTimeNdx ( keys, time) {\n\n        var ndx = -1;\n\n        for ( var i = 0, il = keys.length; i < il && ndx === -1; i ++ ) {\n\n            var key = keys[i];\n\n            if ( key.time >= time ) {\n\n                ndx = i;\n\n            }\n\n        }\n\n        return ndx;\n\n    }\n\n    function interpolateKeys ( keys, key, ndx, fullSid ) {\n\n        var prevKey = getPrevKeyWith( keys, fullSid, ndx ? ndx - 1 : 0 ),\n            nextKey = getNextKeyWith( keys, fullSid, ndx + 1 );\n\n        if ( prevKey && nextKey ) {\n\n            var scale = (key.time - prevKey.time) / (nextKey.time - prevKey.time),\n                prevTarget = prevKey.getTarget( fullSid ),\n                nextData = nextKey.getTarget( fullSid ).data,\n                prevData = prevTarget.data,\n                data;\n\n            if ( prevTarget.type === 'matrix' ) {\n\n                data = prevData;\n\n            } else if ( prevData.length ) {\n\n                data = [];\n\n                for ( var i = 0; i < prevData.length; ++ i ) {\n\n                    data[ i ] = prevData[ i ] + ( nextData[ i ] - prevData[ i ] ) * scale;\n\n                }\n\n            } else {\n\n                data = prevData + ( nextData - prevData ) * scale;\n\n            }\n\n            key.addTarget( fullSid, prevTarget.transform, prevTarget.member, data );\n\n        }\n\n    }\n\n    // Get next key with given sid\n\n    function getNextKeyWith( keys, fullSid, ndx ) {\n\n        for ( ; ndx < keys.length; ndx ++ ) {\n\n            var key = keys[ ndx ];\n\n            if ( key.hasTarget( fullSid ) ) {\n\n                return key;\n\n            }\n\n        }\n\n        return null;\n\n    }\n\n    // Get previous key with given sid\n\n    function getPrevKeyWith( keys, fullSid, ndx ) {\n\n        ndx = ndx >= 0 ? ndx : ndx + keys.length;\n\n        for ( ; ndx >= 0; ndx -- ) {\n\n            var key = keys[ ndx ];\n\n            if ( key.hasTarget( fullSid ) ) {\n\n                return key;\n\n            }\n\n        }\n\n        return null;\n\n    }\n\n    function _Image() {\n\n        this.id = \"\";\n        this.init_from = \"\";\n\n    }\n\n    _Image.prototype.parse = function(element) {\n\n        this.id = element.getAttribute('id');\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n\n            if ( child.nodeName === 'init_from' ) {\n\n                this.init_from = child.textContent;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    function Controller() {\n\n        this.id = \"\";\n        this.name = \"\";\n        this.type = \"\";\n        this.skin = null;\n        this.morph = null;\n\n    }\n\n    Controller.prototype.parse = function( element ) {\n\n        this.id = element.getAttribute('id');\n        this.name = element.getAttribute('name');\n        this.type = \"none\";\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n\n            switch ( child.nodeName ) {\n\n                case 'skin':\n\n                    this.skin = (new Skin()).parse(child);\n                    this.type = child.nodeName;\n                    break;\n\n                case 'morph':\n\n                    this.morph = (new Morph()).parse(child);\n                    this.type = child.nodeName;\n                    break;\n\n                default:\n                    break;\n\n            }\n        }\n\n        return this;\n\n    };\n\n    function Morph() {\n\n        this.method = null;\n        this.source = null;\n        this.targets = null;\n        this.weights = null;\n\n    }\n\n    Morph.prototype.parse = function( element ) {\n\n        var sources = {};\n        var inputs = [];\n        var i;\n\n        this.method = element.getAttribute( 'method' );\n        this.source = element.getAttribute( 'source' ).replace( /^#/, '' );\n\n        for ( i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'source':\n\n                    var source = ( new Source() ).parse( child );\n                    sources[ source.id ] = source;\n                    break;\n\n                case 'targets':\n\n                    inputs = this.parseInputs( child );\n                    break;\n\n                default:\n\n                    console.log( child.nodeName );\n                    break;\n\n            }\n\n        }\n\n        for ( i = 0; i < inputs.length; i ++ ) {\n\n            var input = inputs[ i ];\n            var source = sources[ input.source ];\n\n            switch ( input.semantic ) {\n\n                case 'MORPH_TARGET':\n\n                    this.targets = source.read();\n                    break;\n\n                case 'MORPH_WEIGHT':\n\n                    this.weights = source.read();\n                    break;\n\n                default:\n                    break;\n\n            }\n        }\n\n        return this;\n\n    };\n\n    Morph.prototype.parseInputs = function(element) {\n\n        var inputs = [];\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[i];\n            if ( child.nodeType != 1) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'input':\n\n                    inputs.push( (new Input()).parse(child) );\n                    break;\n\n                default:\n                    break;\n            }\n        }\n\n        return inputs;\n\n    };\n\n    function Skin() {\n\n        this.source = \"\";\n        this.bindShapeMatrix = null;\n        this.invBindMatrices = [];\n        this.joints = [];\n        this.weights = [];\n\n    }\n\n    Skin.prototype.parse = function( element ) {\n\n        var sources = {};\n        var joints, weights;\n\n        this.source = element.getAttribute( 'source' ).replace( /^#/, '' );\n        this.invBindMatrices = [];\n        this.joints = [];\n        this.weights = [];\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[i];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'bind_shape_matrix':\n\n                    var f = _floats(child.textContent);\n                    this.bindShapeMatrix = getConvertedMat4( f );\n                    break;\n\n                case 'source':\n\n                    var src = new Source().parse(child);\n                    sources[ src.id ] = src;\n                    break;\n\n                case 'joints':\n\n                    joints = child;\n                    break;\n\n                case 'vertex_weights':\n\n                    weights = child;\n                    break;\n\n                default:\n\n                    console.log( child.nodeName );\n                    break;\n\n            }\n        }\n\n        this.parseJoints( joints, sources );\n        this.parseWeights( weights, sources );\n\n        return this;\n\n    };\n\n    Skin.prototype.parseJoints = function ( element, sources ) {\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'input':\n\n                    var input = ( new Input() ).parse( child );\n                    var source = sources[ input.source ];\n\n                    if ( input.semantic === 'JOINT' ) {\n\n                        this.joints = source.read();\n\n                    } else if ( input.semantic === 'INV_BIND_MATRIX' ) {\n\n                        this.invBindMatrices = source.read();\n\n                    }\n\n                    break;\n\n                default:\n                    break;\n            }\n\n        }\n\n    };\n\n    Skin.prototype.parseWeights = function ( element, sources ) {\n\n        var v, vcount, inputs = [];\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'input':\n\n                    inputs.push( ( new Input() ).parse( child ) );\n                    break;\n\n                case 'v':\n\n                    v = _ints( child.textContent );\n                    break;\n\n                case 'vcount':\n\n                    vcount = _ints( child.textContent );\n                    break;\n\n                default:\n                    break;\n\n            }\n\n        }\n\n        var index = 0;\n\n        for ( var i = 0; i < vcount.length; i ++ ) {\n\n            var numBones = vcount[i];\n            var vertex_weights = [];\n\n            for ( var j = 0; j < numBones; j ++ ) {\n\n                var influence = {};\n\n                for ( var k = 0; k < inputs.length; k ++ ) {\n\n                    var input = inputs[ k ];\n                    var value = v[ index + input.offset ];\n\n                    switch ( input.semantic ) {\n\n                        case 'JOINT':\n\n                            influence.joint = value;//this.joints[value];\n                            break;\n\n                        case 'WEIGHT':\n\n                            influence.weight = sources[ input.source ].data[ value ];\n                            break;\n\n                        default:\n                            break;\n\n                    }\n\n                }\n\n                vertex_weights.push( influence );\n                index += inputs.length;\n            }\n\n            for ( var j = 0; j < vertex_weights.length; j ++ ) {\n\n                vertex_weights[ j ].index = i;\n\n            }\n\n            this.weights.push( vertex_weights );\n\n        }\n\n    };\n\n    function VisualScene () {\n\n        this.id = \"\";\n        this.name = \"\";\n        this.nodes = [];\n        this.scene = new THREE.Group();\n\n    }\n\n    VisualScene.prototype.getChildById = function( id, recursive ) {\n\n        for ( var i = 0; i < this.nodes.length; i ++ ) {\n\n            var node = this.nodes[ i ].getChildById( id, recursive );\n\n            if ( node ) {\n\n                return node;\n\n            }\n\n        }\n\n        return null;\n\n    };\n\n    VisualScene.prototype.getChildBySid = function( sid, recursive ) {\n\n        for ( var i = 0; i < this.nodes.length; i ++ ) {\n\n            var node = this.nodes[ i ].getChildBySid( sid, recursive );\n\n            if ( node ) {\n\n                return node;\n\n            }\n\n        }\n\n        return null;\n\n    };\n\n    VisualScene.prototype.parse = function( element ) {\n\n        this.id = element.getAttribute( 'id' );\n        this.name = element.getAttribute( 'name' );\n        this.nodes = [];\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'node':\n\n                    this.nodes.push( ( new Node() ).parse( child ) );\n                    break;\n\n                default:\n                    break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    function Node() {\n\n        this.id = \"\";\n        this.name = \"\";\n        this.sid = \"\";\n        this.nodes = [];\n        this.controllers = [];\n        this.transforms = [];\n        this.geometries = [];\n        this.channels = [];\n        this.matrix = new THREE.Matrix4();\n\n    }\n\n    Node.prototype.getChannelForTransform = function( transformSid ) {\n\n        for ( var i = 0; i < this.channels.length; i ++ ) {\n\n            var channel = this.channels[i];\n            var parts = channel.target.split('/');\n            var id = parts.shift();\n            var sid = parts.shift();\n            var dotSyntax = (sid.indexOf(\".\") >= 0);\n            var arrSyntax = (sid.indexOf(\"(\") >= 0);\n            var arrIndices;\n            var member;\n\n            if ( dotSyntax ) {\n\n                parts = sid.split(\".\");\n                sid = parts.shift();\n                member = parts.shift();\n\n            } else if ( arrSyntax ) {\n\n                arrIndices = sid.split(\"(\");\n                sid = arrIndices.shift();\n\n                for ( var j = 0; j < arrIndices.length; j ++ ) {\n\n                    arrIndices[ j ] = parseInt( arrIndices[ j ].replace( /\\)/, '' ) );\n\n                }\n\n            }\n\n            if ( sid === transformSid ) {\n\n                channel.info = { sid: sid, dotSyntax: dotSyntax, arrSyntax: arrSyntax, arrIndices: arrIndices };\n                return channel;\n\n            }\n\n        }\n\n        return null;\n\n    };\n\n    Node.prototype.getChildById = function ( id, recursive ) {\n\n        if ( this.id === id ) {\n\n            return this;\n\n        }\n\n        if ( recursive ) {\n\n            for ( var i = 0; i < this.nodes.length; i ++ ) {\n\n                var n = this.nodes[ i ].getChildById( id, recursive );\n\n                if ( n ) {\n\n                    return n;\n\n                }\n\n            }\n\n        }\n\n        return null;\n\n    };\n\n    Node.prototype.getChildBySid = function ( sid, recursive ) {\n\n        if ( this.sid === sid ) {\n\n            return this;\n\n        }\n\n        if ( recursive ) {\n\n            for ( var i = 0; i < this.nodes.length; i ++ ) {\n\n                var n = this.nodes[ i ].getChildBySid( sid, recursive );\n\n                if ( n ) {\n\n                    return n;\n\n                }\n\n            }\n        }\n\n        return null;\n\n    };\n\n    Node.prototype.getTransformBySid = function ( sid ) {\n\n        for ( var i = 0; i < this.transforms.length; i ++ ) {\n\n            if ( this.transforms[ i ].sid === sid ) return this.transforms[ i ];\n\n        }\n\n        return null;\n\n    };\n\n    Node.prototype.parse = function( element ) {\n\n        var url;\n\n        this.id = element.getAttribute('id');\n        this.sid = element.getAttribute('sid');\n        this.name = element.getAttribute('name');\n        this.type = element.getAttribute('type');\n        this.layer = element.getAttribute('layer');\n\n        this.type = this.type === 'JOINT' ? this.type : 'NODE';\n\n        this.nodes = [];\n        this.transforms = [];\n        this.geometries = [];\n        this.cameras = [];\n        this.lights = [];\n        this.controllers = [];\n        this.matrix = new THREE.Matrix4();\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'node':\n\n                    this.nodes.push( ( new Node() ).parse( child ) );\n                    break;\n\n                case 'instance_camera':\n\n                    this.cameras.push( ( new InstanceCamera() ).parse( child ) );\n                    break;\n\n                case 'instance_controller':\n\n                    this.controllers.push( ( new InstanceController() ).parse( child ) );\n                    break;\n\n                case 'instance_geometry':\n\n                    this.geometries.push( ( new InstanceGeometry() ).parse( child ) );\n                    break;\n\n                case 'instance_light':\n\n                    this.lights.push( ( new InstanceLight() ).parse( child ) );\n                    break;\n\n                case 'instance_node':\n\n                    url = child.getAttribute( 'url' ).replace( /^#/, '' );\n                    var iNode = getLibraryNode( url );\n\n                    if ( iNode ) {\n\n                        this.nodes.push( ( new Node() ).parse( iNode )) ;\n\n                    }\n\n                    break;\n\n                case 'rotate':\n                case 'translate':\n                case 'scale':\n                case 'matrix':\n                case 'lookat':\n                case 'skew':\n\n                    this.transforms.push( ( new Transform() ).parse( child ) );\n                    break;\n\n                case 'extra':\n                    break;\n\n                default:\n\n                    console.log( child.nodeName );\n                    break;\n\n            }\n\n        }\n\n        this.channels = getChannelsForNode( this );\n        bakeAnimations( this );\n\n        this.updateMatrix();\n\n        return this;\n\n    };\n\n    Node.prototype.updateMatrix = function () {\n\n        this.matrix.identity();\n\n        for ( var i = 0; i < this.transforms.length; i ++ ) {\n\n            this.transforms[ i ].apply( this.matrix );\n\n        }\n\n    };\n\n    function Transform () {\n\n        this.sid = \"\";\n        this.type = \"\";\n        this.data = [];\n        this.obj = null;\n\n    }\n\n    Transform.prototype.parse = function ( element ) {\n\n        this.sid = element.getAttribute( 'sid' );\n        this.type = element.nodeName;\n        this.data = _floats( element.textContent );\n        this.convert();\n\n        return this;\n\n    };\n\n    Transform.prototype.convert = function () {\n\n        switch ( this.type ) {\n\n            case 'matrix':\n\n                this.obj = getConvertedMat4( this.data );\n                break;\n\n            case 'rotate':\n\n                this.angle = THREE.Math.degToRad( this.data[3] );\n\n            case 'translate':\n\n                fixCoords( this.data, -1 );\n                this.obj = new THREE.Vector3( this.data[ 0 ], this.data[ 1 ], this.data[ 2 ] );\n                break;\n\n            case 'scale':\n\n                fixCoords( this.data, 1 );\n                this.obj = new THREE.Vector3( this.data[ 0 ], this.data[ 1 ], this.data[ 2 ] );\n                break;\n\n            default:\n                console.log( 'Can not convert Transform of type ' + this.type );\n                break;\n\n        }\n\n    };\n\n    Transform.prototype.apply = function () {\n\n        var m1 = new THREE.Matrix4();\n\n        return function ( matrix ) {\n\n            switch ( this.type ) {\n\n                case 'matrix':\n\n                    matrix.multiply( this.obj );\n\n                    break;\n\n                case 'translate':\n\n                    matrix.multiply( m1.makeTranslation( this.obj.x, this.obj.y, this.obj.z ) );\n\n                    break;\n\n                case 'rotate':\n\n                    matrix.multiply( m1.makeRotationAxis( this.obj, this.angle ) );\n\n                    break;\n\n                case 'scale':\n\n                    matrix.scale( this.obj );\n\n                    break;\n\n            }\n\n        };\n\n    }();\n\n    Transform.prototype.update = function ( data, member ) {\n\n        var members = [ 'X', 'Y', 'Z', 'ANGLE' ];\n\n        switch ( this.type ) {\n\n            case 'matrix':\n\n                if ( ! member ) {\n\n                    this.obj.copy( data );\n\n                } else if ( member.length === 1 ) {\n\n                    switch ( member[ 0 ] ) {\n\n                        case 0:\n\n                            this.obj.n11 = data[ 0 ];\n                            this.obj.n21 = data[ 1 ];\n                            this.obj.n31 = data[ 2 ];\n                            this.obj.n41 = data[ 3 ];\n\n                            break;\n\n                        case 1:\n\n                            this.obj.n12 = data[ 0 ];\n                            this.obj.n22 = data[ 1 ];\n                            this.obj.n32 = data[ 2 ];\n                            this.obj.n42 = data[ 3 ];\n\n                            break;\n\n                        case 2:\n\n                            this.obj.n13 = data[ 0 ];\n                            this.obj.n23 = data[ 1 ];\n                            this.obj.n33 = data[ 2 ];\n                            this.obj.n43 = data[ 3 ];\n\n                            break;\n\n                        case 3:\n\n                            this.obj.n14 = data[ 0 ];\n                            this.obj.n24 = data[ 1 ];\n                            this.obj.n34 = data[ 2 ];\n                            this.obj.n44 = data[ 3 ];\n\n                            break;\n\n                    }\n\n                } else if ( member.length === 2 ) {\n\n                    var propName = 'n' + ( member[ 0 ] + 1 ) + ( member[ 1 ] + 1 );\n                    this.obj[ propName ] = data;\n\n                } else {\n\n                    console.log('Incorrect addressing of matrix in transform.');\n\n                }\n\n                break;\n\n            case 'translate':\n            case 'scale':\n\n                if ( Object.prototype.toString.call( member ) === '[object Array]' ) {\n\n                    member = members[ member[ 0 ] ];\n\n                }\n\n                switch ( member ) {\n\n                    case 'X':\n\n                        this.obj.x = data;\n                        break;\n\n                    case 'Y':\n\n                        this.obj.y = data;\n                        break;\n\n                    case 'Z':\n\n                        this.obj.z = data;\n                        break;\n\n                    default:\n\n                        this.obj.x = data[ 0 ];\n                        this.obj.y = data[ 1 ];\n                        this.obj.z = data[ 2 ];\n                        break;\n\n                }\n\n                break;\n\n            case 'rotate':\n\n                if ( Object.prototype.toString.call( member ) === '[object Array]' ) {\n\n                    member = members[ member[ 0 ] ];\n\n                }\n\n                switch ( member ) {\n\n                    case 'X':\n\n                        this.obj.x = data;\n                        break;\n\n                    case 'Y':\n\n                        this.obj.y = data;\n                        break;\n\n                    case 'Z':\n\n                        this.obj.z = data;\n                        break;\n\n                    case 'ANGLE':\n\n                        this.angle = THREE.Math.degToRad( data );\n                        break;\n\n                    default:\n\n                        this.obj.x = data[ 0 ];\n                        this.obj.y = data[ 1 ];\n                        this.obj.z = data[ 2 ];\n                        this.angle = THREE.Math.degToRad( data[ 3 ] );\n                        break;\n\n                }\n                break;\n\n        }\n\n    };\n\n    function InstanceController() {\n\n        this.url = \"\";\n        this.skeleton = [];\n        this.instance_material = [];\n\n    }\n\n    InstanceController.prototype.parse = function ( element ) {\n\n        this.url = element.getAttribute('url').replace(/^#/, '');\n        this.skeleton = [];\n        this.instance_material = [];\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType !== 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'skeleton':\n\n                    this.skeleton.push( child.textContent.replace(/^#/, '') );\n                    break;\n\n                case 'bind_material':\n\n                    var instances = child.querySelectorAll('instance_material');\n\n                    for ( var j = 0; j < instances.length; j ++ ) {\n\n                        var instance = instances[j];\n                        this.instance_material.push( (new InstanceMaterial()).parse(instance) );\n\n                    }\n\n\n                    break;\n\n                case 'extra':\n                    break;\n\n                default:\n                    break;\n\n            }\n        }\n\n        return this;\n\n    };\n\n    function InstanceMaterial () {\n\n        this.symbol = \"\";\n        this.target = \"\";\n\n    }\n\n    InstanceMaterial.prototype.parse = function ( element ) {\n\n        this.symbol = element.getAttribute('symbol');\n        this.target = element.getAttribute('target').replace(/^#/, '');\n        return this;\n\n    };\n\n    function InstanceGeometry() {\n\n        this.url = \"\";\n        this.instance_material = [];\n\n    }\n\n    InstanceGeometry.prototype.parse = function ( element ) {\n\n        this.url = element.getAttribute('url').replace(/^#/, '');\n        this.instance_material = [];\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[i];\n            if ( child.nodeType != 1 ) continue;\n\n            if ( child.nodeName === 'bind_material' ) {\n\n                var instances = child.querySelectorAll('instance_material');\n\n                for ( var j = 0; j < instances.length; j ++ ) {\n\n                    var instance = instances[j];\n                    this.instance_material.push( (new InstanceMaterial()).parse(instance) );\n\n                }\n\n                break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    function Geometry() {\n\n        this.id = \"\";\n        this.mesh = null;\n\n    }\n\n    Geometry.prototype.parse = function ( element ) {\n\n        this.id = element.getAttribute('id');\n\n        extractDoubleSided( this, element );\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[i];\n\n            switch ( child.nodeName ) {\n\n                case 'mesh':\n\n                    this.mesh = (new Mesh(this)).parse(child);\n                    break;\n\n                case 'extra':\n\n                    // console.log( child );\n                    break;\n\n                default:\n                    break;\n            }\n        }\n\n        return this;\n\n    };\n\n    function Mesh( geometry ) {\n\n        this.geometry = geometry.id;\n        this.primitives = [];\n        this.vertices = null;\n        this.geometry3js = null;\n\n    }\n\n    Mesh.prototype.parse = function ( element ) {\n\n        this.primitives = [];\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n\n            switch ( child.nodeName ) {\n\n                case 'source':\n\n                    _source( child );\n                    break;\n\n                case 'vertices':\n\n                    this.vertices = ( new Vertices() ).parse( child );\n                    break;\n\n                case 'linestrips':\n\n                    this.primitives.push( ( new LineStrips().parse( child ) ) );\n                    break;\n\n                case 'triangles':\n\n                    this.primitives.push( ( new Triangles().parse( child ) ) );\n                    break;\n\n                case 'polygons':\n\n                    this.primitives.push( ( new Polygons().parse( child ) ) );\n                    break;\n\n                case 'polylist':\n\n                    this.primitives.push( ( new Polylist().parse( child ) ) );\n                    break;\n\n                default:\n                    break;\n\n            }\n\n        }\n\n        this.geometry3js = new THREE.Geometry();\n\n        if ( this.vertices === null ) {\n\n            // TODO (mrdoob): Study case when this is null (carrier.dae)\n\n            return this;\n\n        }\n\n        var vertexData = sources[ this.vertices.input['POSITION'].source ].data;\n\n        for ( var i = 0; i < vertexData.length; i += 3 ) {\n\n            this.geometry3js.vertices.push( getConvertedVec3( vertexData, i ).clone() );\n\n        }\n\n        for ( var i = 0; i < this.primitives.length; i ++ ) {\n\n            var primitive = this.primitives[ i ];\n            primitive.setVertices( this.vertices );\n            this.handlePrimitive( primitive, this.geometry3js );\n\n        }\n\n        if ( this.geometry3js.calcNormals ) {\n\n            this.geometry3js.computeVertexNormals();\n            delete this.geometry3js.calcNormals;\n\n        }\n\n        return this;\n\n    };\n\n    Mesh.prototype.handlePrimitive = function ( primitive, geom ) {\n\n        if ( primitive instanceof LineStrips ) {\n\n            // TODO: Handle indices. Maybe easier with BufferGeometry?\n\n            geom.isLineStrip = true;\n            return;\n\n        }\n\n        var j, k, pList = primitive.p, inputs = primitive.inputs;\n        var input, index, idx32;\n        var source, numParams;\n        var vcIndex = 0, vcount = 3, maxOffset = 0;\n        var texture_sets = [];\n\n        for ( j = 0; j < inputs.length; j ++ ) {\n\n            input = inputs[ j ];\n\n            var offset = input.offset + 1;\n            maxOffset = (maxOffset < offset) ? offset : maxOffset;\n\n            switch ( input.semantic ) {\n\n                case 'TEXCOORD':\n                    texture_sets.push( input.set );\n                    break;\n\n            }\n\n        }\n\n        for ( var pCount = 0; pCount < pList.length; ++ pCount ) {\n\n            var p = pList[ pCount ], i = 0;\n\n            while ( i < p.length ) {\n\n                var vs = [];\n                var ns = [];\n                var ts = null;\n                var cs = [];\n\n                if ( primitive.vcount ) {\n\n                    vcount = primitive.vcount.length ? primitive.vcount[ vcIndex ++ ] : primitive.vcount;\n\n                } else {\n\n                    vcount = p.length / maxOffset;\n\n                }\n\n\n                for ( j = 0; j < vcount; j ++ ) {\n\n                    for ( k = 0; k < inputs.length; k ++ ) {\n\n                        input = inputs[ k ];\n                        source = sources[ input.source ];\n\n                        index = p[ i + ( j * maxOffset ) + input.offset ];\n                        numParams = source.accessor.params.length;\n                        idx32 = index * numParams;\n\n                        switch ( input.semantic ) {\n\n                            case 'VERTEX':\n\n                                vs.push( index );\n\n                                break;\n\n                            case 'NORMAL':\n\n                                ns.push( getConvertedVec3( source.data, idx32 ) );\n\n                                break;\n\n                            case 'TEXCOORD':\n\n                                ts = ts || { };\n                                if ( ts[ input.set ] === undefined ) ts[ input.set ] = [];\n                                // invert the V\n                                ts[ input.set ].push( new THREE.Vector2( source.data[ idx32 ], source.data[ idx32 + 1 ] ) );\n\n                                break;\n\n                            case 'COLOR':\n\n                                cs.push( new THREE.Color().setRGB( source.data[ idx32 ], source.data[ idx32 + 1 ], source.data[ idx32 + 2 ] ) );\n\n                                break;\n\n                            default:\n\n                                break;\n\n                        }\n\n                    }\n\n                }\n\n                if ( ns.length === 0 ) {\n\n                    // check the vertices inputs\n                    input = this.vertices.input.NORMAL;\n\n                    if ( input ) {\n\n                        source = sources[ input.source ];\n                        numParams = source.accessor.params.length;\n\n                        for ( var ndx = 0, len = vs.length; ndx < len; ndx ++ ) {\n\n                            ns.push( getConvertedVec3( source.data, vs[ ndx ] * numParams ) );\n\n                        }\n\n                    } else {\n\n                        geom.calcNormals = true;\n\n                    }\n\n                }\n\n                if ( !ts ) {\n\n                    ts = { };\n                    // check the vertices inputs\n                    input = this.vertices.input.TEXCOORD;\n\n                    if ( input ) {\n\n                        texture_sets.push( input.set );\n                        source = sources[ input.source ];\n                        numParams = source.accessor.params.length;\n\n                        for ( var ndx = 0, len = vs.length; ndx < len; ndx ++ ) {\n\n                            idx32 = vs[ ndx ] * numParams;\n                            if ( ts[ input.set ] === undefined ) ts[ input.set ] = [ ];\n                            // invert the V\n                            ts[ input.set ].push( new THREE.Vector2( source.data[ idx32 ], 1.0 - source.data[ idx32 + 1 ] ) );\n\n                        }\n\n                    }\n\n                }\n\n                if ( cs.length === 0 ) {\n\n                    // check the vertices inputs\n                    input = this.vertices.input.COLOR;\n\n                    if ( input ) {\n\n                        source = sources[ input.source ];\n                        numParams = source.accessor.params.length;\n\n                        for ( var ndx = 0, len = vs.length; ndx < len; ndx ++ ) {\n\n                            idx32 = vs[ ndx ] * numParams;\n                            cs.push( new THREE.Color().setRGB( source.data[ idx32 ], source.data[ idx32 + 1 ], source.data[ idx32 + 2 ] ) );\n\n                        }\n\n                    }\n\n                }\n\n                var face = null, faces = [], uv, uvArr;\n\n                if ( vcount === 3 ) {\n\n                    faces.push( new THREE.Face3( vs[0], vs[1], vs[2], ns, cs.length ? cs : new THREE.Color() ) );\n\n                } else if ( vcount === 4 ) {\n\n                    faces.push( new THREE.Face3( vs[0], vs[1], vs[3], ns.length ? [ ns[0].clone(), ns[1].clone(), ns[3].clone() ] : [], cs.length ? [ cs[0], cs[1], cs[3] ] : new THREE.Color() ) );\n\n                    faces.push( new THREE.Face3( vs[1], vs[2], vs[3], ns.length ? [ ns[1].clone(), ns[2].clone(), ns[3].clone() ] : [], cs.length ? [ cs[1], cs[2], cs[3] ] : new THREE.Color() ) );\n\n                } else if ( vcount > 4 && options.subdivideFaces ) {\n\n                    var clr = cs.length ? cs : new THREE.Color(),\n                        vec1, vec2, vec3, v1, v2, norm;\n\n                    // subdivide into multiple Face3s\n\n                    for ( k = 1; k < vcount - 1; ) {\n\n                        faces.push( new THREE.Face3( vs[0], vs[k], vs[k + 1], ns.length ? [ ns[0].clone(), ns[k ++].clone(), ns[k].clone() ] : [], clr ) );\n\n                    }\n\n                }\n\n                if ( faces.length ) {\n\n                    for ( var ndx = 0, len = faces.length; ndx < len; ndx ++ ) {\n\n                        face = faces[ndx];\n                        face.daeMaterial = primitive.material;\n                        geom.faces.push( face );\n\n                        for ( k = 0; k < texture_sets.length; k ++ ) {\n\n                            uv = ts[ texture_sets[k] ];\n\n                            if ( vcount > 4 ) {\n\n                                // Grab the right UVs for the vertices in this face\n                                uvArr = [ uv[0], uv[ndx + 1], uv[ndx + 2] ];\n\n                            } else if ( vcount === 4 ) {\n\n                                if ( ndx === 0 ) {\n\n                                    uvArr = [ uv[0], uv[1], uv[3] ];\n\n                                } else {\n\n                                    uvArr = [ uv[1].clone(), uv[2], uv[3].clone() ];\n\n                                }\n\n                            } else {\n\n                                uvArr = [ uv[0], uv[1], uv[2] ];\n\n                            }\n\n                            if ( geom.faceVertexUvs[k] === undefined ) {\n\n                                geom.faceVertexUvs[k] = [];\n\n                            }\n\n                            geom.faceVertexUvs[k].push( uvArr );\n\n                        }\n\n                    }\n\n                } else {\n\n                    console.log( 'dropped face with vcount ' + vcount + ' for geometry with id: ' + geom.id );\n\n                }\n\n                i += maxOffset * vcount;\n\n            }\n\n        }\n\n    };\n\n    function Polygons () {\n\n        this.material = \"\";\n        this.count = 0;\n        this.inputs = [];\n        this.vcount = null;\n        this.p = [];\n        this.geometry = new THREE.Geometry();\n\n    }\n\n    Polygons.prototype.setVertices = function ( vertices ) {\n\n        for ( var i = 0; i < this.inputs.length; i ++ ) {\n\n            if ( this.inputs[ i ].source === vertices.id ) {\n\n                this.inputs[ i ].source = vertices.input[ 'POSITION' ].source;\n\n            }\n\n        }\n\n    };\n\n    Polygons.prototype.parse = function ( element ) {\n\n        this.material = element.getAttribute( 'material' );\n        this.count = _attr_as_int( element, 'count', 0 );\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n\n            switch ( child.nodeName ) {\n\n                case 'input':\n\n                    this.inputs.push( ( new Input() ).parse( element.childNodes[ i ] ) );\n                    break;\n\n                case 'vcount':\n\n                    this.vcount = _ints( child.textContent );\n                    break;\n\n                case 'p':\n\n                    this.p.push( _ints( child.textContent ) );\n                    break;\n\n                case 'ph':\n\n                    console.warn( 'polygon holes not yet supported!' );\n                    break;\n\n                default:\n                    break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    function Polylist () {\n\n        Polygons.call( this );\n\n        this.vcount = [];\n\n    }\n\n    Polylist.prototype = Object.create( Polygons.prototype );\n    Polylist.prototype.constructor = Polylist;\n\n    function LineStrips() {\n\n        Polygons.call( this );\n\n        this.vcount = 1;\n\n    }\n\n    LineStrips.prototype = Object.create( Polygons.prototype );\n    LineStrips.prototype.constructor = LineStrips;\n\n    function Triangles () {\n\n        Polygons.call( this );\n\n        this.vcount = 3;\n\n    }\n\n    Triangles.prototype = Object.create( Polygons.prototype );\n    Triangles.prototype.constructor = Triangles;\n\n    function Accessor() {\n\n        this.source = \"\";\n        this.count = 0;\n        this.stride = 0;\n        this.params = [];\n\n    }\n\n    Accessor.prototype.parse = function ( element ) {\n\n        this.params = [];\n        this.source = element.getAttribute( 'source' );\n        this.count = _attr_as_int( element, 'count', 0 );\n        this.stride = _attr_as_int( element, 'stride', 0 );\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n\n            if ( child.nodeName === 'param' ) {\n\n                var param = {};\n                param[ 'name' ] = child.getAttribute( 'name' );\n                param[ 'type' ] = child.getAttribute( 'type' );\n                this.params.push( param );\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    function Vertices() {\n\n        this.input = {};\n\n    }\n\n    Vertices.prototype.parse = function ( element ) {\n\n        this.id = element.getAttribute('id');\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            if ( element.childNodes[i].nodeName === 'input' ) {\n\n                var input = ( new Input() ).parse( element.childNodes[ i ] );\n                this.input[ input.semantic ] = input;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    function Input () {\n\n        this.semantic = \"\";\n        this.offset = 0;\n        this.source = \"\";\n        this.set = 0;\n\n    }\n\n    Input.prototype.parse = function ( element ) {\n\n        this.semantic = element.getAttribute('semantic');\n        this.source = element.getAttribute('source').replace(/^#/, '');\n        this.set = _attr_as_int(element, 'set', -1);\n        this.offset = _attr_as_int(element, 'offset', 0);\n\n        if ( this.semantic === 'TEXCOORD' && this.set < 0 ) {\n\n            this.set = 0;\n\n        }\n\n        return this;\n\n    };\n\n    function Source ( id ) {\n\n        this.id = id;\n        this.type = null;\n\n    }\n\n    Source.prototype.parse = function ( element ) {\n\n        this.id = element.getAttribute( 'id' );\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[i];\n\n            switch ( child.nodeName ) {\n\n                case 'bool_array':\n\n                    this.data = _bools( child.textContent );\n                    this.type = child.nodeName;\n                    break;\n\n                case 'float_array':\n\n                    this.data = _floats( child.textContent );\n                    this.type = child.nodeName;\n                    break;\n\n                case 'int_array':\n\n                    this.data = _ints( child.textContent );\n                    this.type = child.nodeName;\n                    break;\n\n                case 'IDREF_array':\n                case 'Name_array':\n\n                    this.data = _strings( child.textContent );\n                    this.type = child.nodeName;\n                    break;\n\n                case 'technique_common':\n\n                    for ( var j = 0; j < child.childNodes.length; j ++ ) {\n\n                        if ( child.childNodes[ j ].nodeName === 'accessor' ) {\n\n                            this.accessor = ( new Accessor() ).parse( child.childNodes[ j ] );\n                            break;\n\n                        }\n                    }\n                    break;\n\n                default:\n                    // console.log(child.nodeName);\n                    break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    Source.prototype.read = function () {\n\n        var result = [];\n\n        //for (var i = 0; i < this.accessor.params.length; i++) {\n\n        var param = this.accessor.params[ 0 ];\n\n            //console.log(param.name + \" \" + param.type);\n\n        switch ( param.type ) {\n\n            case 'IDREF':\n            case 'Name': case 'name':\n            case 'float':\n\n                return this.data;\n\n            case 'float4x4':\n\n                for ( var j = 0; j < this.data.length; j += 16 ) {\n\n                    var s = this.data.slice( j, j + 16 );\n                    var m = getConvertedMat4( s );\n                    result.push( m );\n                }\n\n                break;\n\n            default:\n\n                console.log( 'ColladaLoader: Source: Read dont know how to read ' + param.type + '.' );\n                break;\n\n        }\n\n        //}\n\n        return result;\n\n    };\n\n    function Material () {\n\n        this.id = \"\";\n        this.name = \"\";\n        this.instance_effect = null;\n\n    }\n\n    Material.prototype.parse = function ( element ) {\n\n        this.id = element.getAttribute( 'id' );\n        this.name = element.getAttribute( 'name' );\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            if ( element.childNodes[ i ].nodeName === 'instance_effect' ) {\n\n                this.instance_effect = ( new InstanceEffect() ).parse( element.childNodes[ i ] );\n                break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    function ColorOrTexture () {\n\n        this.color = new THREE.Color();\n        this.color.setRGB( Math.random(), Math.random(), Math.random() );\n        this.color.a = 1.0;\n\n        this.texture = null;\n        this.texcoord = null;\n        this.texOpts = null;\n\n    }\n\n    ColorOrTexture.prototype.isColor = function () {\n\n        return ( this.texture === null );\n\n    };\n\n    ColorOrTexture.prototype.isTexture = function () {\n\n        return ( this.texture != null );\n\n    };\n\n    ColorOrTexture.prototype.parse = function ( element ) {\n\n        if (element.nodeName === 'transparent') {\n\n            this.opaque = element.getAttribute('opaque');\n\n        }\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'color':\n\n                    var rgba = _floats( child.textContent );\n                    this.color = new THREE.Color();\n                    this.color.setRGB( rgba[0], rgba[1], rgba[2] );\n                    this.color.a = rgba[3];\n                    break;\n\n                case 'texture':\n\n                    this.texture = child.getAttribute('texture');\n                    this.texcoord = child.getAttribute('texcoord');\n                    // Defaults from:\n                    // https://collada.org/mediawiki/index.php/Maya_texture_placement_MAYA_extension\n                    this.texOpts = {\n                        offsetU: 0,\n                        offsetV: 0,\n                        repeatU: 1,\n                        repeatV: 1,\n                        wrapU: 1,\n                        wrapV: 1\n                    };\n                    this.parseTexture( child );\n                    break;\n\n                default:\n                    break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    ColorOrTexture.prototype.parseTexture = function ( element ) {\n\n        if ( ! element.childNodes ) return this;\n\n        // This should be supported by Maya, 3dsMax, and MotionBuilder\n\n        if ( element.childNodes[1] && element.childNodes[1].nodeName === 'extra' ) {\n\n            element = element.childNodes[1];\n\n            if ( element.childNodes[1] && element.childNodes[1].nodeName === 'technique' ) {\n\n                element = element.childNodes[1];\n\n            }\n\n        }\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n\n            switch ( child.nodeName ) {\n\n                case 'offsetU':\n                case 'offsetV':\n                case 'repeatU':\n                case 'repeatV':\n\n                    this.texOpts[ child.nodeName ] = parseFloat( child.textContent );\n\n                    break;\n\n                case 'wrapU':\n                case 'wrapV':\n\n                    // some dae have a value of true which becomes NaN via parseInt\n\n                    if ( child.textContent.toUpperCase() === 'TRUE' ) {\n\n                        this.texOpts[ child.nodeName ] = 1;\n\n                    } else {\n\n                        this.texOpts[ child.nodeName ] = parseInt( child.textContent );\n\n                    }\n                    break;\n\n                default:\n\n                    this.texOpts[ child.nodeName ] = child.textContent;\n\n                    break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    function Shader ( type, effect ) {\n\n        this.type = type;\n        this.effect = effect;\n        this.material = null;\n\n    }\n\n    Shader.prototype.parse = function ( element ) {\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'emission':\n                case 'diffuse':\n                case 'specular':\n                case 'transparent':\n\n                    this[ child.nodeName ] = ( new ColorOrTexture() ).parse( child );\n                    break;\n\n                case 'bump':\n\n                    // If 'bumptype' is 'heightfield', create a 'bump' property\n                    // Else if 'bumptype' is 'normalmap', create a 'normal' property\n                    // (Default to 'bump')\n                    var bumpType = child.getAttribute( 'bumptype' );\n                    if ( bumpType ) {\n                        if ( bumpType.toLowerCase() === \"heightfield\" ) {\n                            this[ 'bump' ] = ( new ColorOrTexture() ).parse( child );\n                        } else if ( bumpType.toLowerCase() === \"normalmap\" ) {\n                            this[ 'normal' ] = ( new ColorOrTexture() ).parse( child );\n                        } else {\n                            console.error( \"Shader.prototype.parse: Invalid value for attribute 'bumptype' (\" + bumpType + \") - valid bumptypes are 'HEIGHTFIELD' and 'NORMALMAP' - defaulting to 'HEIGHTFIELD'\" );\n                            this[ 'bump' ] = ( new ColorOrTexture() ).parse( child );\n                        }\n                    } else {\n                        console.warn( \"Shader.prototype.parse: Attribute 'bumptype' missing from bump node - defaulting to 'HEIGHTFIELD'\" );\n                        this[ 'bump' ] = ( new ColorOrTexture() ).parse( child );\n                    }\n\n                    break;\n\n                case 'shininess':\n                case 'reflectivity':\n                case 'index_of_refraction':\n                case 'transparency':\n\n                    var f = child.querySelectorAll('float');\n\n                    if ( f.length > 0 )\n                        this[ child.nodeName ] = parseFloat( f[ 0 ].textContent );\n\n                    break;\n\n                default:\n                    break;\n\n            }\n\n        }\n\n        this.create();\n        return this;\n\n    };\n\n    Shader.prototype.create = function() {\n\n        var props = {};\n\n        var transparent = false;\n\n        if (this['transparency'] !== undefined && this['transparent'] !== undefined) {\n            // convert transparent color RBG to average value\n            var transparentColor = this['transparent'];\n            var transparencyLevel = (this.transparent.color.r + this.transparent.color.g + this.transparent.color.b) / 3 * this.transparency;\n\n            if (transparencyLevel > 0) {\n                transparent = true;\n                props[ 'transparent' ] = true;\n                props[ 'opacity' ] = 1 - transparencyLevel;\n\n            }\n\n        }\n\n        var keys = {\n            'diffuse':'map',\n            'ambient':'lightMap',\n            'specular':'specularMap',\n            'emission':'emissionMap',\n            'bump':'bumpMap',\n            'normal':'normalMap'\n            };\n\n        for ( var prop in this ) {\n\n            switch ( prop ) {\n\n                case 'ambient':\n                case 'emission':\n                case 'diffuse':\n                case 'specular':\n                case 'bump':\n                case 'normal':\n\n                    var cot = this[ prop ];\n\n                    if ( cot instanceof ColorOrTexture ) {\n\n                        if ( cot.isTexture() ) {\n\n                            var samplerId = cot.texture;\n                            var surfaceId = this.effect.sampler[samplerId];\n\n                            if ( surfaceId !== undefined && surfaceId.source !== undefined ) {\n\n                                var surface = this.effect.surface[surfaceId.source];\n\n                                if ( surface !== undefined ) {\n\n                                    var image = images[ surface.init_from ];\n\n                                    if ( image ) {\n\n                                        var url = baseUrl + image.init_from;\n\n                                        var texture;\n                                        var loader = THREE.Loader.Handlers.get( url );\n\n                                        if ( loader !== null ) {\n\n                                            texture = loader.load( url );\n\n                                        } else {\n\n                                            texture = new THREE.Texture();\n\n                                            loadTextureImage( texture, url );\n\n                                        }\n\n                                        texture.wrapS = cot.texOpts.wrapU ? THREE.RepeatWrapping : THREE.ClampToEdgeWrapping;\n                                        texture.wrapT = cot.texOpts.wrapV ? THREE.RepeatWrapping : THREE.ClampToEdgeWrapping;\n                                        texture.offset.x = cot.texOpts.offsetU;\n                                        texture.offset.y = cot.texOpts.offsetV;\n                                        texture.repeat.x = cot.texOpts.repeatU;\n                                        texture.repeat.y = cot.texOpts.repeatV;\n                                        props[keys[prop]] = texture;\n\n                                        // Texture with baked lighting?\n                                        if (prop === 'emission') props['emissive'] = 0xffffff;\n\n                                    }\n\n                                }\n\n                            }\n\n                        } else if ( prop === 'diffuse' || !transparent ) {\n\n                            if ( prop === 'emission' ) {\n\n                                props[ 'emissive' ] = cot.color.getHex();\n\n                            } else {\n\n                                props[ prop ] = cot.color.getHex();\n\n                            }\n\n                        }\n\n                    }\n\n                    break;\n\n                case 'shininess':\n\n                    props[ prop ] = this[ prop ];\n                    break;\n\n                case 'reflectivity':\n\n                    props[ prop ] = this[ prop ];\n                    if ( props[ prop ] > 0.0 ) props['envMap'] = options.defaultEnvMap;\n                    props['combine'] = THREE.MixOperation;\t//mix regular shading with reflective component\n                    break;\n\n                case 'index_of_refraction':\n\n                    props[ 'refractionRatio' ] = this[ prop ]; //TODO: \"index_of_refraction\" becomes \"refractionRatio\" in shader, but I'm not sure if the two are actually comparable\n                    if ( this[ prop ] !== 1.0 ) props['envMap'] = options.defaultEnvMap;\n                    break;\n\n                case 'transparency':\n                    // gets figured out up top\n                    break;\n\n                default:\n                    break;\n\n            }\n\n        }\n\n        props[ 'shading' ] = preferredShading;\n        props[ 'side' ] = this.effect.doubleSided ? THREE.DoubleSide : THREE.FrontSide;\n\n        if ( props.diffuse !== undefined ) {\n\n            props.color = props.diffuse;\n            delete props.diffuse;\n\n        }\n\n        switch ( this.type ) {\n\n            case 'constant':\n\n                if (props.emissive != undefined) props.color = props.emissive;\n                this.material = new THREE.MeshBasicMaterial( props );\n                break;\n\n            case 'phong':\n            case 'blinn':\n\n                this.material = new THREE.MeshPhongMaterial( props );\n                break;\n\n            case 'lambert':\n            default:\n\n                this.material = new THREE.MeshLambertMaterial( props );\n                break;\n\n        }\n\n        return this.material;\n\n    };\n\n    function Surface ( effect ) {\n\n        this.effect = effect;\n        this.init_from = null;\n        this.format = null;\n\n    }\n\n    Surface.prototype.parse = function ( element ) {\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'init_from':\n\n                    this.init_from = child.textContent;\n                    break;\n\n                case 'format':\n\n                    this.format = child.textContent;\n                    break;\n\n                default:\n\n                    console.log( \"unhandled Surface prop: \" + child.nodeName );\n                    break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    function Sampler2D ( effect ) {\n\n        this.effect = effect;\n        this.source = null;\n        this.wrap_s = null;\n        this.wrap_t = null;\n        this.minfilter = null;\n        this.magfilter = null;\n        this.mipfilter = null;\n\n    }\n\n    Sampler2D.prototype.parse = function ( element ) {\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'source':\n\n                    this.source = child.textContent;\n                    break;\n\n                case 'minfilter':\n\n                    this.minfilter = child.textContent;\n                    break;\n\n                case 'magfilter':\n\n                    this.magfilter = child.textContent;\n                    break;\n\n                case 'mipfilter':\n\n                    this.mipfilter = child.textContent;\n                    break;\n\n                case 'wrap_s':\n\n                    this.wrap_s = child.textContent;\n                    break;\n\n                case 'wrap_t':\n\n                    this.wrap_t = child.textContent;\n                    break;\n\n                default:\n\n                    console.log( \"unhandled Sampler2D prop: \" + child.nodeName );\n                    break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    function Effect () {\n\n        this.id = \"\";\n        this.name = \"\";\n        this.shader = null;\n        this.surface = {};\n        this.sampler = {};\n\n    }\n\n    Effect.prototype.create = function () {\n\n        if ( this.shader === null ) {\n\n            return null;\n\n        }\n\n    };\n\n    Effect.prototype.parse = function ( element ) {\n\n        this.id = element.getAttribute( 'id' );\n        this.name = element.getAttribute( 'name' );\n\n        extractDoubleSided( this, element );\n\n        this.shader = null;\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'profile_COMMON':\n\n                    this.parseTechnique( this.parseProfileCOMMON( child ) );\n                    break;\n\n                default:\n                    break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    Effect.prototype.parseNewparam = function ( element ) {\n\n        var sid = element.getAttribute( 'sid' );\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'surface':\n\n                    this.surface[sid] = ( new Surface( this ) ).parse( child );\n                    break;\n\n                case 'sampler2D':\n\n                    this.sampler[sid] = ( new Sampler2D( this ) ).parse( child );\n                    break;\n\n                case 'extra':\n\n                    break;\n\n                default:\n\n                    console.log( child.nodeName );\n                    break;\n\n            }\n\n        }\n\n    };\n\n    Effect.prototype.parseProfileCOMMON = function ( element ) {\n\n        var technique;\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'profile_COMMON':\n\n                    this.parseProfileCOMMON( child );\n                    break;\n\n                case 'technique':\n\n                    technique = child;\n                    break;\n\n                case 'newparam':\n\n                    this.parseNewparam( child );\n                    break;\n\n                case 'image':\n\n                    var _image = ( new _Image() ).parse( child );\n                    images[ _image.id ] = _image;\n                    break;\n\n                case 'extra':\n                    break;\n\n                default:\n\n                    console.log( child.nodeName );\n                    break;\n\n            }\n\n        }\n\n        return technique;\n\n    };\n\n    Effect.prototype.parseTechnique = function ( element ) {\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[i];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'constant':\n                case 'lambert':\n                case 'blinn':\n                case 'phong':\n\n                    this.shader = ( new Shader( child.nodeName, this ) ).parse( child );\n                    break;\n                case 'extra':\n                    this.parseExtra(child);\n                    break;\n                default:\n                    break;\n\n            }\n\n        }\n\n    };\n\n    Effect.prototype.parseExtra = function ( element ) {\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[i];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'technique':\n                    this.parseExtraTechnique( child );\n                    break;\n                default:\n                    break;\n\n            }\n\n        }\n\n    };\n\n    Effect.prototype.parseExtraTechnique = function ( element ) {\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[i];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'bump':\n                    this.shader.parse( element );\n                    break;\n                default:\n                    break;\n\n            }\n\n        }\n\n    };\n\n    function InstanceEffect () {\n\n        this.url = \"\";\n\n    }\n\n    InstanceEffect.prototype.parse = function ( element ) {\n\n        this.url = element.getAttribute( 'url' ).replace( /^#/, '' );\n        return this;\n\n    };\n\n    function Animation() {\n\n        this.id = \"\";\n        this.name = \"\";\n        this.source = {};\n        this.sampler = [];\n        this.channel = [];\n\n    }\n\n    Animation.prototype.parse = function ( element ) {\n\n        this.id = element.getAttribute( 'id' );\n        this.name = element.getAttribute( 'name' );\n        this.source = {};\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'animation':\n\n                    var anim = ( new Animation() ).parse( child );\n\n                    for ( var src in anim.source ) {\n\n                        this.source[ src ] = anim.source[ src ];\n\n                    }\n\n                    for ( var j = 0; j < anim.channel.length; j ++ ) {\n\n                        this.channel.push( anim.channel[ j ] );\n                        this.sampler.push( anim.sampler[ j ] );\n\n                    }\n\n                    break;\n\n                case 'source':\n\n                    var src = ( new Source() ).parse( child );\n                    this.source[ src.id ] = src;\n                    break;\n\n                case 'sampler':\n\n                    this.sampler.push( ( new Sampler( this ) ).parse( child ) );\n                    break;\n\n                case 'channel':\n\n                    this.channel.push( ( new Channel( this ) ).parse( child ) );\n                    break;\n\n                default:\n                    break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    function Channel( animation ) {\n\n        this.animation = animation;\n        this.source = \"\";\n        this.target = \"\";\n        this.fullSid = null;\n        this.sid = null;\n        this.dotSyntax = null;\n        this.arrSyntax = null;\n        this.arrIndices = null;\n        this.member = null;\n\n    }\n\n    Channel.prototype.parse = function ( element ) {\n\n        this.source = element.getAttribute( 'source' ).replace( /^#/, '' );\n        this.target = element.getAttribute( 'target' );\n\n        var parts = this.target.split( '/' );\n\n        var id = parts.shift();\n        var sid = parts.shift();\n\n        var dotSyntax = ( sid.indexOf(\".\") >= 0 );\n        var arrSyntax = ( sid.indexOf(\"(\") >= 0 );\n\n        if ( dotSyntax ) {\n\n            parts = sid.split(\".\");\n            this.sid = parts.shift();\n            this.member = parts.shift();\n\n        } else if ( arrSyntax ) {\n\n            var arrIndices = sid.split(\"(\");\n            this.sid = arrIndices.shift();\n\n            for (var j = 0; j < arrIndices.length; j ++ ) {\n\n                arrIndices[j] = parseInt( arrIndices[j].replace(/\\)/, '') );\n\n            }\n\n            this.arrIndices = arrIndices;\n\n        } else {\n\n            this.sid = sid;\n\n        }\n\n        this.fullSid = sid;\n        this.dotSyntax = dotSyntax;\n        this.arrSyntax = arrSyntax;\n\n        return this;\n\n    };\n\n    function Sampler ( animation ) {\n\n        this.id = \"\";\n        this.animation = animation;\n        this.inputs = [];\n        this.input = null;\n        this.output = null;\n        this.strideOut = null;\n        this.interpolation = null;\n        this.startTime = null;\n        this.endTime = null;\n        this.duration = 0;\n\n    }\n\n    Sampler.prototype.parse = function ( element ) {\n\n        this.id = element.getAttribute( 'id' );\n        this.inputs = [];\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'input':\n\n                    this.inputs.push( (new Input()).parse( child ) );\n                    break;\n\n                default:\n                    break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    Sampler.prototype.create = function () {\n\n        for ( var i = 0; i < this.inputs.length; i ++ ) {\n\n            var input = this.inputs[ i ];\n            var source = this.animation.source[ input.source ];\n\n            switch ( input.semantic ) {\n\n                case 'INPUT':\n\n                    this.input = source.read();\n                    break;\n\n                case 'OUTPUT':\n\n                    this.output = source.read();\n                    this.strideOut = source.accessor.stride;\n                    break;\n\n                case 'INTERPOLATION':\n\n                    this.interpolation = source.read();\n                    break;\n\n                case 'IN_TANGENT':\n\n                    break;\n\n                case 'OUT_TANGENT':\n\n                    break;\n\n                default:\n\n                    console.log(input.semantic);\n                    break;\n\n            }\n\n        }\n\n        this.startTime = 0;\n        this.endTime = 0;\n        this.duration = 0;\n\n        if ( this.input.length ) {\n\n            this.startTime = 100000000;\n            this.endTime = -100000000;\n\n            for ( var i = 0; i < this.input.length; i ++ ) {\n\n                this.startTime = Math.min( this.startTime, this.input[ i ] );\n                this.endTime = Math.max( this.endTime, this.input[ i ] );\n\n            }\n\n            this.duration = this.endTime - this.startTime;\n\n        }\n\n    };\n\n    Sampler.prototype.getData = function ( type, ndx, member ) {\n\n        var data;\n\n        if ( type === 'matrix' && this.strideOut === 16 ) {\n\n            data = this.output[ ndx ];\n\n        } else if ( this.strideOut > 1 ) {\n\n            data = [];\n            ndx *= this.strideOut;\n\n            for ( var i = 0; i < this.strideOut; ++ i ) {\n\n                data[ i ] = this.output[ ndx + i ];\n\n            }\n\n            if ( this.strideOut === 3 ) {\n\n                switch ( type ) {\n\n                    case 'rotate':\n                    case 'translate':\n\n                        fixCoords( data, -1 );\n                        break;\n\n                    case 'scale':\n\n                        fixCoords( data, 1 );\n                        break;\n\n                }\n\n            } else if ( this.strideOut === 4 && type === 'matrix' ) {\n\n                fixCoords( data, -1 );\n\n            }\n\n        } else {\n\n            data = this.output[ ndx ];\n\n            if ( member && type === 'translate' ) {\n                data = getConvertedTranslation( member, data );\n            }\n\n        }\n\n        return data;\n\n    };\n\n    function Key ( time ) {\n\n        this.targets = [];\n        this.time = time;\n\n    }\n\n    Key.prototype.addTarget = function ( fullSid, transform, member, data ) {\n\n        this.targets.push( {\n            sid: fullSid,\n            member: member,\n            transform: transform,\n            data: data\n        } );\n\n    };\n\n    Key.prototype.apply = function ( opt_sid ) {\n\n        for ( var i = 0; i < this.targets.length; ++ i ) {\n\n            var target = this.targets[ i ];\n\n            if ( !opt_sid || target.sid === opt_sid ) {\n\n                target.transform.update( target.data, target.member );\n\n            }\n\n        }\n\n    };\n\n    Key.prototype.getTarget = function ( fullSid ) {\n\n        for ( var i = 0; i < this.targets.length; ++ i ) {\n\n            if ( this.targets[ i ].sid === fullSid ) {\n\n                return this.targets[ i ];\n\n            }\n\n        }\n\n        return null;\n\n    };\n\n    Key.prototype.hasTarget = function ( fullSid ) {\n\n        for ( var i = 0; i < this.targets.length; ++ i ) {\n\n            if ( this.targets[ i ].sid === fullSid ) {\n\n                return true;\n\n            }\n\n        }\n\n        return false;\n\n    };\n\n    // TODO: Currently only doing linear interpolation. Should support full COLLADA spec.\n    Key.prototype.interpolate = function ( nextKey, time ) {\n\n        for ( var i = 0, l = this.targets.length; i < l; i ++ ) {\n\n            var target = this.targets[ i ],\n                nextTarget = nextKey.getTarget( target.sid ),\n                data;\n\n            if ( target.transform.type !== 'matrix' && nextTarget ) {\n\n                var scale = ( time - this.time ) / ( nextKey.time - this.time ),\n                    nextData = nextTarget.data,\n                    prevData = target.data;\n\n                if ( scale < 0 ) scale = 0;\n                if ( scale > 1 ) scale = 1;\n\n                if ( prevData.length ) {\n\n                    data = [];\n\n                    for ( var j = 0; j < prevData.length; ++ j ) {\n\n                        data[ j ] = prevData[ j ] + ( nextData[ j ] - prevData[ j ] ) * scale;\n\n                    }\n\n                } else {\n\n                    data = prevData + ( nextData - prevData ) * scale;\n\n                }\n\n            } else {\n\n                data = target.data;\n\n            }\n\n            target.transform.update( data, target.member );\n\n        }\n\n    };\n\n    // Camera\n    function Camera() {\n\n        this.id = \"\";\n        this.name = \"\";\n        this.technique = \"\";\n\n    }\n\n    Camera.prototype.parse = function ( element ) {\n\n        this.id = element.getAttribute( 'id' );\n        this.name = element.getAttribute( 'name' );\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'optics':\n\n                    this.parseOptics( child );\n                    break;\n\n                default:\n                    break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    Camera.prototype.parseOptics = function ( element ) {\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            if ( element.childNodes[ i ].nodeName === 'technique_common' ) {\n\n                var technique = element.childNodes[ i ];\n\n                for ( var j = 0; j < technique.childNodes.length; j ++ ) {\n\n                    this.technique = technique.childNodes[ j ].nodeName;\n\n                    if ( this.technique === 'perspective' ) {\n\n                        var perspective = technique.childNodes[ j ];\n\n                        for ( var k = 0; k < perspective.childNodes.length; k ++ ) {\n\n                            var param = perspective.childNodes[ k ];\n\n                            switch ( param.nodeName ) {\n\n                                case 'yfov':\n                                    this.yfov = param.textContent;\n                                    break;\n                                case 'xfov':\n                                    this.xfov = param.textContent;\n                                    break;\n                                case 'znear':\n                                    this.znear = param.textContent;\n                                    break;\n                                case 'zfar':\n                                    this.zfar = param.textContent;\n                                    break;\n                                case 'aspect_ratio':\n                                    this.aspect_ratio = param.textContent;\n                                    break;\n\n                            }\n\n                        }\n\n                    } else if ( this.technique === 'orthographic' ) {\n\n                        var orthographic = technique.childNodes[ j ];\n\n                        for ( var k = 0; k < orthographic.childNodes.length; k ++ ) {\n\n                            var param = orthographic.childNodes[ k ];\n\n                            switch ( param.nodeName ) {\n\n                                case 'xmag':\n                                    this.xmag = param.textContent;\n                                    break;\n                                case 'ymag':\n                                    this.ymag = param.textContent;\n                                    break;\n                                case 'znear':\n                                    this.znear = param.textContent;\n                                    break;\n                                case 'zfar':\n                                    this.zfar = param.textContent;\n                                    break;\n                                case 'aspect_ratio':\n                                    this.aspect_ratio = param.textContent;\n                                    break;\n\n                            }\n\n                        }\n\n                    }\n\n                }\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    function InstanceCamera() {\n\n        this.url = \"\";\n\n    }\n\n    InstanceCamera.prototype.parse = function ( element ) {\n\n        this.url = element.getAttribute('url').replace(/^#/, '');\n\n        return this;\n\n    };\n\n    // Light\n\n    function Light() {\n\n        this.id = \"\";\n        this.name = \"\";\n        this.technique = \"\";\n\n    }\n\n    Light.prototype.parse = function ( element ) {\n\n        this.id = element.getAttribute( 'id' );\n        this.name = element.getAttribute( 'name' );\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'technique_common':\n\n                    this.parseCommon( child );\n                    break;\n\n                case 'technique':\n\n                    this.parseTechnique( child );\n                    break;\n\n                default:\n                    break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    Light.prototype.parseCommon = function ( element ) {\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            switch ( element.childNodes[ i ].nodeName ) {\n\n                case 'directional':\n                case 'point':\n                case 'spot':\n                case 'ambient':\n\n                    this.technique = element.childNodes[ i ].nodeName;\n\n                    var light = element.childNodes[ i ];\n\n                    for ( var j = 0; j < light.childNodes.length; j ++ ) {\n\n                        var child = light.childNodes[j];\n\n                        switch ( child.nodeName ) {\n\n                            case 'color':\n\n                                var rgba = _floats( child.textContent );\n                                this.color = new THREE.Color(0);\n                                this.color.setRGB( rgba[0], rgba[1], rgba[2] );\n                                this.color.a = rgba[3];\n                                break;\n\n                            case 'falloff_angle':\n\n                                this.falloff_angle = parseFloat( child.textContent );\n                                break;\n\n                            case 'quadratic_attenuation':\n                                var f = parseFloat( child.textContent );\n                                this.distance = f ? Math.sqrt( 1 / f ) : 0;\n                        }\n\n                    }\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    Light.prototype.parseTechnique = function ( element ) {\n\n        this.profile = element.getAttribute( 'profile' );\n\n        for ( var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n\n            switch ( child.nodeName ) {\n\n                case 'intensity':\n\n                    this.intensity = parseFloat(child.textContent);\n                    break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    function InstanceLight() {\n\n        this.url = \"\";\n\n    }\n\n    InstanceLight.prototype.parse = function ( element ) {\n\n        this.url = element.getAttribute('url').replace(/^#/, '');\n\n        return this;\n\n    };\n\n    function KinematicsModel( ) {\n\n        this.id = '';\n        this.name = '';\n        this.joints = [];\n        this.links = [];\n\n    }\n\n    KinematicsModel.prototype.parse = function( element ) {\n\n        this.id = element.getAttribute('id');\n        this.name = element.getAttribute('name');\n        this.joints = [];\n        this.links = [];\n\n        for (var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'technique_common':\n\n                    this.parseCommon(child);\n                    break;\n\n                default:\n                    break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    KinematicsModel.prototype.parseCommon = function( element ) {\n\n        for (var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( element.childNodes[ i ].nodeName ) {\n\n                case 'joint':\n                    this.joints.push( (new Joint()).parse(child) );\n                    break;\n\n                case 'link':\n                    this.links.push( (new Link()).parse(child) );\n                    break;\n\n                default:\n                    break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    function Joint( ) {\n\n        this.sid = '';\n        this.name = '';\n        this.axis = new THREE.Vector3();\n        this.limits = {\n            min: 0,\n            max: 0\n        };\n        this.type = '';\n        this.static = false;\n        this.zeroPosition = 0.0;\n        this.middlePosition = 0.0;\n\n    }\n\n    Joint.prototype.parse = function( element ) {\n\n        this.sid = element.getAttribute('sid');\n        this.name = element.getAttribute('name');\n        this.axis = new THREE.Vector3();\n        this.limits = {\n            min: 0,\n            max: 0\n        };\n        this.type = '';\n        this.static = false;\n        this.zeroPosition = 0.0;\n        this.middlePosition = 0.0;\n\n        var axisElement = element.querySelector('axis');\n        var _axis = _floats(axisElement.textContent);\n        this.axis = getConvertedVec3(_axis, 0);\n\n        var min = element.querySelector('limits min') ? parseFloat(element.querySelector('limits min').textContent) : -360;\n        var max = element.querySelector('limits max') ? parseFloat(element.querySelector('limits max').textContent) : 360;\n\n        this.limits = {\n            min: min,\n            max: max\n        };\n\n        var jointTypes = [ 'prismatic', 'revolute' ];\n        for (var i = 0; i < jointTypes.length; i ++ ) {\n\n            var type = jointTypes[ i ];\n\n            var jointElement = element.querySelector(type);\n\n            if ( jointElement ) {\n\n                this.type = type;\n\n            }\n\n        }\n\n        // if the min is equal to or somehow greater than the max, consider the joint static\n        if ( this.limits.min >= this.limits.max ) {\n\n            this.static = true;\n\n        }\n\n        this.middlePosition = (this.limits.min + this.limits.max) / 2.0;\n        return this;\n\n    };\n\n    function Link( ) {\n\n        this.sid = '';\n        this.name = '';\n        this.transforms = [];\n        this.attachments = [];\n\n    }\n\n    Link.prototype.parse = function( element ) {\n\n        this.sid = element.getAttribute('sid');\n        this.name = element.getAttribute('name');\n        this.transforms = [];\n        this.attachments = [];\n\n        for (var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'attachment_full':\n                    this.attachments.push( (new Attachment()).parse(child) );\n                    break;\n\n                case 'rotate':\n                case 'translate':\n                case 'matrix':\n\n                    this.transforms.push( (new Transform()).parse(child) );\n                    break;\n\n                default:\n\n                    break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    function Attachment( ) {\n\n        this.joint = '';\n        this.transforms = [];\n        this.links = [];\n\n    }\n\n    Attachment.prototype.parse = function( element ) {\n\n        this.joint = element.getAttribute('joint').split('/').pop();\n        this.links = [];\n\n        for (var i = 0; i < element.childNodes.length; i ++ ) {\n\n            var child = element.childNodes[ i ];\n            if ( child.nodeType != 1 ) continue;\n\n            switch ( child.nodeName ) {\n\n                case 'link':\n                    this.links.push( (new Link()).parse(child) );\n                    break;\n\n                case 'rotate':\n                case 'translate':\n                case 'matrix':\n\n                    this.transforms.push( (new Transform()).parse(child) );\n                    break;\n\n                default:\n\n                    break;\n\n            }\n\n        }\n\n        return this;\n\n    };\n\n    function _source( element ) {\n\n        var id = element.getAttribute( 'id' );\n\n        if ( sources[ id ] != undefined ) {\n\n            return sources[ id ];\n\n        }\n\n        sources[ id ] = ( new Source(id )).parse( element );\n        return sources[ id ];\n\n    }\n\n    function _nsResolver( nsPrefix ) {\n\n        if ( nsPrefix === \"dae\" ) {\n\n            return \"http://www.collada.org/2005/11/COLLADASchema\";\n\n        }\n\n        return null;\n\n    }\n\n    function _bools( str ) {\n\n        var raw = _strings( str );\n        var data = [];\n\n        for ( var i = 0, l = raw.length; i < l; i ++ ) {\n\n            data.push( (raw[i] === 'true' || raw[i] === '1') ? true : false );\n\n        }\n\n        return data;\n\n    }\n\n    function _floats( str ) {\n\n        var raw = _strings(str);\n        var data = [];\n\n        for ( var i = 0, l = raw.length; i < l; i ++ ) {\n\n            data.push( parseFloat( raw[ i ] ) );\n\n        }\n\n        return data;\n\n    }\n\n    function _ints( str ) {\n\n        var raw = _strings( str );\n        var data = [];\n\n        for ( var i = 0, l = raw.length; i < l; i ++ ) {\n\n            data.push( parseInt( raw[ i ], 10 ) );\n\n        }\n\n        return data;\n\n    }\n\n    function _strings( str ) {\n\n        return ( str.length > 0 ) ? _trimString( str ).split( /\\s+/ ) : [];\n\n    }\n\n    function _trimString( str ) {\n\n        return str.replace( /^\\s+/, \"\" ).replace( /\\s+$/, \"\" );\n\n    }\n\n    function _attr_as_float( element, name, defaultValue ) {\n\n        if ( element.hasAttribute( name ) ) {\n\n            return parseFloat( element.getAttribute( name ) );\n\n        } else {\n\n            return defaultValue;\n\n        }\n\n    }\n\n    function _attr_as_int( element, name, defaultValue ) {\n\n        if ( element.hasAttribute( name ) ) {\n\n            return parseInt( element.getAttribute( name ), 10) ;\n\n        } else {\n\n            return defaultValue;\n\n        }\n\n    }\n\n    function _attr_as_string( element, name, defaultValue ) {\n\n        if ( element.hasAttribute( name ) ) {\n\n            return element.getAttribute( name );\n\n        } else {\n\n            return defaultValue;\n\n        }\n\n    }\n\n    function _format_float( f, num ) {\n\n        if ( f === undefined ) {\n\n            var s = '0.';\n\n            while ( s.length < num + 2 ) {\n\n                s += '0';\n\n            }\n\n            return s;\n\n        }\n\n        num = num || 2;\n\n        var parts = f.toString().split( '.' );\n        parts[ 1 ] = parts.length > 1 ? parts[ 1 ].substr( 0, num ) : \"0\";\n\n        while ( parts[ 1 ].length < num ) {\n\n            parts[ 1 ] += '0';\n\n        }\n\n        return parts.join( '.' );\n\n    }\n\n    function loadTextureImage ( texture, url ) {\n\n        var loader = new THREE.ImageLoader();\n\n        loader.load( url, function ( image ) {\n\n            texture.image = image;\n            texture.needsUpdate = true;\n\n        } );\n\n    }\n\n    function extractDoubleSided( obj, element ) {\n\n        obj.doubleSided = false;\n\n        var node = element.querySelectorAll('extra double_sided')[0];\n\n        if ( node ) {\n\n            if ( node && parseInt( node.textContent, 10 ) === 1 ) {\n\n                obj.doubleSided = true;\n\n            }\n\n        }\n\n    }\n\n    // Up axis conversion\n\n    function setUpConversion() {\n\n        if ( options.convertUpAxis !== true || colladaUp === options.upAxis ) {\n\n            upConversion = null;\n\n        } else {\n\n            switch ( colladaUp ) {\n\n                case 'X':\n\n                    upConversion = options.upAxis === 'Y' ? 'XtoY' : 'XtoZ';\n                    break;\n\n                case 'Y':\n\n                    upConversion = options.upAxis === 'X' ? 'YtoX' : 'YtoZ';\n                    break;\n\n                case 'Z':\n\n                    upConversion = options.upAxis === 'X' ? 'ZtoX' : 'ZtoY';\n                    break;\n\n            }\n\n        }\n\n    }\n\n    function fixCoords( data, sign ) {\n\n        if ( options.convertUpAxis !== true || colladaUp === options.upAxis ) {\n\n            return;\n\n        }\n\n        switch ( upConversion ) {\n\n            case 'XtoY':\n\n                var tmp = data[ 0 ];\n                data[ 0 ] = sign * data[ 1 ];\n                data[ 1 ] = tmp;\n                break;\n\n            case 'XtoZ':\n\n                var tmp = data[ 2 ];\n                data[ 2 ] = data[ 1 ];\n                data[ 1 ] = data[ 0 ];\n                data[ 0 ] = tmp;\n                break;\n\n            case 'YtoX':\n\n                var tmp = data[ 0 ];\n                data[ 0 ] = data[ 1 ];\n                data[ 1 ] = sign * tmp;\n                break;\n\n            case 'YtoZ':\n\n                var tmp = data[ 1 ];\n                data[ 1 ] = sign * data[ 2 ];\n                data[ 2 ] = tmp;\n                break;\n\n            case 'ZtoX':\n\n                var tmp = data[ 0 ];\n                data[ 0 ] = data[ 1 ];\n                data[ 1 ] = data[ 2 ];\n                data[ 2 ] = tmp;\n                break;\n\n            case 'ZtoY':\n\n                var tmp = data[ 1 ];\n                data[ 1 ] = data[ 2 ];\n                data[ 2 ] = sign * tmp;\n                break;\n\n        }\n\n    }\n\n    function getConvertedTranslation( axis, data ) {\n\n        if ( options.convertUpAxis !== true || colladaUp === options.upAxis ) {\n\n            return data;\n\n        }\n\n        switch ( axis ) {\n            case 'X':\n                data = upConversion === 'XtoY' ? data * -1 : data;\n                break;\n            case 'Y':\n                data = upConversion === 'YtoZ' || upConversion === 'YtoX' ? data * -1 : data;\n                break;\n            case 'Z':\n                data = upConversion === 'ZtoY' ? data * -1 : data ;\n                break;\n            default:\n                break;\n        }\n\n        return data;\n    }\n\n    function getConvertedVec3( data, offset ) {\n\n        var arr = [ data[ offset ], data[ offset + 1 ], data[ offset + 2 ] ];\n        fixCoords( arr, -1 );\n        return new THREE.Vector3( arr[ 0 ], arr[ 1 ], arr[ 2 ] );\n\n    }\n\n    function getConvertedMat4( data ) {\n\n        if ( options.convertUpAxis ) {\n\n            // First fix rotation and scale\n\n            // Columns first\n            var arr = [ data[ 0 ], data[ 4 ], data[ 8 ] ];\n            fixCoords( arr, -1 );\n            data[ 0 ] = arr[ 0 ];\n            data[ 4 ] = arr[ 1 ];\n            data[ 8 ] = arr[ 2 ];\n            arr = [ data[ 1 ], data[ 5 ], data[ 9 ] ];\n            fixCoords( arr, -1 );\n            data[ 1 ] = arr[ 0 ];\n            data[ 5 ] = arr[ 1 ];\n            data[ 9 ] = arr[ 2 ];\n            arr = [ data[ 2 ], data[ 6 ], data[ 10 ] ];\n            fixCoords( arr, -1 );\n            data[ 2 ] = arr[ 0 ];\n            data[ 6 ] = arr[ 1 ];\n            data[ 10 ] = arr[ 2 ];\n            // Rows second\n            arr = [ data[ 0 ], data[ 1 ], data[ 2 ] ];\n            fixCoords( arr, -1 );\n            data[ 0 ] = arr[ 0 ];\n            data[ 1 ] = arr[ 1 ];\n            data[ 2 ] = arr[ 2 ];\n            arr = [ data[ 4 ], data[ 5 ], data[ 6 ] ];\n            fixCoords( arr, -1 );\n            data[ 4 ] = arr[ 0 ];\n            data[ 5 ] = arr[ 1 ];\n            data[ 6 ] = arr[ 2 ];\n            arr = [ data[ 8 ], data[ 9 ], data[ 10 ] ];\n            fixCoords( arr, -1 );\n            data[ 8 ] = arr[ 0 ];\n            data[ 9 ] = arr[ 1 ];\n            data[ 10 ] = arr[ 2 ];\n\n            // Now fix translation\n            arr = [ data[ 3 ], data[ 7 ], data[ 11 ] ];\n            fixCoords( arr, -1 );\n            data[ 3 ] = arr[ 0 ];\n            data[ 7 ] = arr[ 1 ];\n            data[ 11 ] = arr[ 2 ];\n\n        }\n\n        return new THREE.Matrix4().set(\n            data[0], data[1], data[2], data[3],\n            data[4], data[5], data[6], data[7],\n            data[8], data[9], data[10], data[11],\n            data[12], data[13], data[14], data[15]\n            );\n\n    }\n\n    function getConvertedIndex( index ) {\n\n        if ( index > -1 && index < 3 ) {\n\n            var members = [ 'X', 'Y', 'Z' ],\n                indices = { X: 0, Y: 1, Z: 2 };\n\n            index = getConvertedMember( members[ index ] );\n            index = indices[ index ];\n\n        }\n\n        return index;\n\n    }\n\n    function getConvertedMember( member ) {\n\n        if ( options.convertUpAxis ) {\n\n            switch ( member ) {\n\n                case 'X':\n\n                    switch ( upConversion ) {\n\n                        case 'XtoY':\n                        case 'XtoZ':\n                        case 'YtoX':\n\n                            member = 'Y';\n                            break;\n\n                        case 'ZtoX':\n\n                            member = 'Z';\n                            break;\n\n                    }\n\n                    break;\n\n                case 'Y':\n\n                    switch ( upConversion ) {\n\n                        case 'XtoY':\n                        case 'YtoX':\n                        case 'ZtoX':\n\n                            member = 'X';\n                            break;\n\n                        case 'XtoZ':\n                        case 'YtoZ':\n                        case 'ZtoY':\n\n                            member = 'Z';\n                            break;\n\n                    }\n\n                    break;\n\n                case 'Z':\n\n                    switch ( upConversion ) {\n\n                        case 'XtoZ':\n\n                            member = 'X';\n                            break;\n\n                        case 'YtoZ':\n                        case 'ZtoX':\n                        case 'ZtoY':\n\n                            member = 'Y';\n                            break;\n\n                    }\n\n                    break;\n\n            }\n\n        }\n\n        return member;\n\n    }\n\n    return {\n\n        load: load,\n        parse: parse,\n        setPreferredShading: setPreferredShading,\n        applySkin: applySkin,\n        geometries : geometries,\n        options: options\n\n    };\n\n};\n\nmodule.exports = ColladaLoader;\n"],"sourceRoot":""}